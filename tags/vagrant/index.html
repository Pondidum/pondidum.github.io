<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>vagrant | Andy Dote</title><meta name=keywords content><meta name=description content><meta name=author content><link rel=canonical href=https://andydote.co.uk/tags/vagrant/><link crossorigin=anonymous href=/assets/css/stylesheet.min.b4e19c453811e60acfec1f00c15ac2be1c53f6ab90187e684358ce7faaf48bab.css integrity="sha256-tOGcRTgR5grP7B8AwVrCvhxT9quQGH5oQ1jOf6r0i6s=" rel="preload stylesheet" as=style><link rel=icon href=https://andydote.co.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://andydote.co.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://andydote.co.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://andydote.co.uk/apple-touch-icon.png><link rel=mask-icon href=https://andydote.co.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://andydote.co.uk/tags/vagrant/rss.xml><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="vagrant"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://andydote.co.uk/tags/vagrant/"><meta name=twitter:card content="summary"><meta name=twitter:title content="vagrant"><meta name=twitter:description content></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://andydote.co.uk accesskey=h title="Andy Dote (Alt + H)">Andy Dote</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://andydote.co.uk/archive title=Archive><span>Archive</span></a></li><li><a href=https://andydote.co.uk/talks title=Talks><span>Talks</span></a></li><li><a href=https://andydote.co.uk/notes title=Notes><span>Notes</span></a></li><li><a href=https://andydote.co.uk/tags title=Tags><span>Tags</span></a></li><li><a href=https://andydote.co.uk/contact title=Contact><span>Contact</span></a></li><li><a href=https://andydote.co.uk/rss.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><header class=page-header><h1>vagrant</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2>Libvirt Hostname Resolution</h2></header><div class=entry-content><p>I use Vagrant when testing new machines and experimenting locally with clusters, and since moving (mostly) to Linux, I have been using the LibVirt Plugin to create the virtual machines. Not only is it significantly faster than Hyper-V was on windows, but it also means I don’t need to use Oracle products, so it’s win-win really.
The only configuration challenge I have had with it is setting up VM hostname resolution, and as I forget how to do it each time, I figured I should write about it....</p></div><footer class=entry-footer><span title="2019-12-22 00:00:00 +0000 UTC">December 22, 2019</span>&nbsp;·&nbsp;3 min</footer><a class=entry-link aria-label="post link to Libvirt Hostname Resolution" href=https://andydote.co.uk/2019/12/22/libvirt-hostname-resolution/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Canary Routing with Traefik in Nomad</h2></header><div class=entry-content><p>I wanted to implement canary routing for some HTTP services deployed via Nomad the other day, but rather than having the traffic split by weighting to the containers, I wanted to direct the traffic based on a header.
My first choice of tech was to use Fabio, but it only supports routing by URL prefix, and additionally with a route weight. While I was at JustDevOps in Poland, I heard about another router/loadbalancer which worked in a similar way to Fabio: Traefik....</p></div><footer class=entry-footer><span title="2019-06-23 00:00:00 +0000 UTC">June 23, 2019</span>&nbsp;·&nbsp;8 min</footer><a class=entry-link aria-label="post link to Canary Routing with Traefik in Nomad" href=https://andydote.co.uk/2019/06/23/nomad-traefik-canary/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Running a Secure RabbitMQ Cluster in Nomad</h2></header><div class=entry-content><p>Last time I wrote about running a RabbitMQ cluster in Nomad, one of the main pieces of feedback I received was about the (lack) of security of the setup, so I decided to revisit this, and write about how to launch as secure RabbitMQ node in Nomad.
The things I want to cover are:
Username and Password for the management UI Secure value for the Erlang Cookie SSL for Management and AMQP As usual, the demo repository with all the code is available if you’d rather just jump into that....</p></div><footer class=entry-footer><span title="2019-04-06 00:00:00 +0000 UTC">April 6, 2019</span>&nbsp;·&nbsp;9 min</footer><a class=entry-link aria-label="post link to Running a Secure RabbitMQ Cluster in Nomad" href=https://andydote.co.uk/2019/04/06/nomad-rabbitmq-secure/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Hyper-V, Docker, and Networking Drama</h2></header><div class=entry-content><p>I had a major problem a few hours before giving my Nomad: Kubernetes Without the Complexity talk this morning: the demo stopped working.
Now, the first thing to note is the entire setup of the demo is scripted, and the scripts hadn’t changed. The only thing I had done was restart the machine, and now things were breaking.
The Symptoms A docker container started inside the guest VMs with a port mapped to the machine’s public IP wasn’t resolvable outside the host....</p></div><footer class=entry-footer><span title="2019-03-22 00:00:00 +0000 UTC">March 22, 2019</span>&nbsp;·&nbsp;3 min</footer><a class=entry-link aria-label="post link to Hyper-V, Docker, and Networking Drama" href=https://andydote.co.uk/2019/03/22/hyperv-networking/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>RabbitMQ clustering with Consul in Nomad</h2></header><div class=entry-content><p>Update If you want a secure version of this cluster, see Running a Secure RabbitMQ Cluster in Nomad.
RabbitMQ is the centre of a lot of micros service architectures, and while you can cluster it manually, it is a lot easier to use some of the auto clustering plugins, such as AWS (EC2), Consul, Etcd, or Kubernetes. As I like to use Nomad for container orchestration, I thought it would be a good idea to show how to cluster RabbitMQ when it is running in a Docker container, on an unknown host (i....</p></div><footer class=entry-footer><span title="2019-01-28 00:00:00 +0000 UTC">January 28, 2019</span>&nbsp;·&nbsp;9 min</footer><a class=entry-link aria-label="post link to RabbitMQ clustering with Consul in Nomad" href=https://andydote.co.uk/2019/01/28/nomad-rabbitmq-consul-cluster/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Testing Immutable Infrastructure</h2></header><div class=entry-content><p>In my previous post, I glossed over one of the most important and useful parts of Immutable Infrastructure: Testability. There are many kinds of tests we can write for our infrastructure, but they should all be focused on the machine/service and maybe it’s nearest dependencies, not the entire system.
While this post focuses on testing a full machine (both locally in a VM, and remotely as an Amazon EC2 instance), it is also possible to do most of the same kind of tests against a Docker container....</p></div><footer class=entry-footer><span title="2019-01-01 00:00:00 +0000 UTC">January 1, 2019</span>&nbsp;·&nbsp;17 min</footer><a class=entry-link aria-label="post link to Testing Immutable Infrastructure" href=https://andydote.co.uk/2019/01/01/immutable-infra/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Vagrant in the world of Docker</h2></header><div class=entry-content><p>I gave a little talk at work recently on my use of Vagrant, what it is, and why it is still useful in a world full of Docker containers.
So, What is Vagrant? Vagrant is a product by Hashicorp, and is for scripting the creation of (temporary) virtual machines. It’s pretty fast to create a virtual machine with too, as it creates them from a base image (known as a “box”....</p></div><footer class=entry-footer><span title="2017-10-22 00:00:00 +0000 UTC">October 22, 2017</span>&nbsp;·&nbsp;4 min</footer><a class=entry-link aria-label="post link to Vagrant in the world of Docker" href=https://andydote.co.uk/2017/10/22/vagrant-in-a-world-of-docker/></a></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>
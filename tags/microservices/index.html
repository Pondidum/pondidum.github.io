<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>microservices | Andy Dote</title><meta name=keywords content><meta name=description content><meta name=author content><link rel=canonical href=https://andydote.co.uk/tags/microservices/><link crossorigin=anonymous href=/assets/css/stylesheet.min.b4e19c453811e60acfec1f00c15ac2be1c53f6ab90187e684358ce7faaf48bab.css integrity="sha256-tOGcRTgR5grP7B8AwVrCvhxT9quQGH5oQ1jOf6r0i6s=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/mermaid.min.725f44bd345b0a2a4043ca952b0863edd789e913cf0813a12bbdfe986fe87079.js integrity="sha256-cl9EvTRbCipAQ8qVKwhj7deJ6RPPCBOhK73+mG/ocHk="></script>
<link rel=icon href=https://andydote.co.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://andydote.co.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://andydote.co.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://andydote.co.uk/apple-touch-icon.png><link rel=mask-icon href=https://andydote.co.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://andydote.co.uk/tags/microservices/rss.xml><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="microservices"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://andydote.co.uk/tags/microservices/"><meta name=twitter:card content="summary"><meta name=twitter:title content="microservices"><meta name=twitter:description content></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://andydote.co.uk accesskey=h title="Andy Dote (Alt + H)">Andy Dote</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://andydote.co.uk/archive title=Archive><span>Archive</span></a></li><li><a href=https://andydote.co.uk/talks title=Talks><span>Talks</span></a></li><li><a href=https://andydote.co.uk/notes title=Notes><span>Notes</span></a></li><li><a href=https://andydote.co.uk/tags title=Tags><span>Tags</span></a></li><li><a href=https://andydote.co.uk/contact title=Contact><span>Contact</span></a></li><li><a href=https://andydote.co.uk/rss.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><header class=page-header><h1>microservices</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2>Service Mesh with Consul Connect (and Nomad)</h2></header><div class=entry-content><p>When it comes to implementing a new feature in an application’s ecosystem, I don’t like spending my innovation tokens unless I have to, so I try not to add new tools to my infrastructure unless I really need them.
This same approach comes when I either want, need, or have been told, to implement a Service Mesh. This means I don’t instantly setup Istio. Not because it’s bad - far from it - but because it’s extra complexity I would rather avoid, unless I need it....</p></div><footer class=entry-footer><span title='2020-05-04 00:00:00 +0000 UTC'>May 4, 2020</span>&nbsp;·&nbsp;6 min</footer><a class=entry-link aria-label="post link to Service Mesh with Consul Connect (and Nomad)" href=https://andydote.co.uk/2020/05/04/service-mesh-consul-connect/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Feature Toggles: Reducing Coupling</h2></header><div class=entry-content><p>One of the points I make in my Feature Toggles talk is that you shouldn’t be querying a toggle’s status all over your codebase. Ideally, each toggle gets checked in as few places as possible - preferably only one place. The advantage of doing this is that very little of your codebase needs to be coupled to the toggles (either the toggle itself or the library/system for managing toggles itself)....</p></div><footer class=entry-footer><span title='2019-06-11 00:00:00 +0000 UTC'>June 11, 2019</span>&nbsp;·&nbsp;6 min</footer><a class=entry-link aria-label="post link to Feature Toggles: Reducing Coupling" href=https://andydote.co.uk/2019/06/11/feature-toggles-reducing-coupling/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Feature Toggles: Branch by Abstraction</h2></header><div class=entry-content><p>Recently, I was asked if I could provide an example of Branch By Abstraction when dealing with feature toggles. As this has come up a few times, I thought a blog post would be a good idea so I can refer others to it later too.
The Context As usual, this is some kind of backend (micro)service, and it will send email messages somehow. We will start with two implementations of message sending: the “current” version; which is synchronous, and a “new” version; which is async....</p></div><footer class=entry-footer><span title='2019-06-03 00:00:00 +0000 UTC'>June 3, 2019</span>&nbsp;·&nbsp;4 min</footer><a class=entry-link aria-label="post link to Feature Toggles: Branch by Abstraction" href=https://andydote.co.uk/2019/06/03/feature-toggles-branch-by-abstraction/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Testing Immutable Infrastructure</h2></header><div class=entry-content><p>In my previous post, I glossed over one of the most important and useful parts of Immutable Infrastructure: Testability. There are many kinds of tests we can write for our infrastructure, but they should all be focused on the machine/service and maybe it’s nearest dependencies, not the entire system.
While this post focuses on testing a full machine (both locally in a VM, and remotely as an Amazon EC2 instance), it is also possible to do most of the same kind of tests against a Docker container....</p></div><footer class=entry-footer><span title='2019-01-01 00:00:00 +0000 UTC'>January 1, 2019</span>&nbsp;·&nbsp;17 min</footer><a class=entry-link aria-label="post link to Testing Immutable Infrastructure" href=https://andydote.co.uk/2019/01/01/immutable-infra/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Code-free tracing with LogStash and Jaeger</h2></header><div class=entry-content><p>I wanted to show request charts (similar to the network tab in firefox) for requests across our microservices but wanted to do so in the least invasive way possible.
We already use LogStash to collect logs from multiple hosts (via FileBeat) and forward them on to ElasticSearch, so perhaps I can do something to also output from LogStash to a tracing service.
There are a number of tracing services available (AppDash, Jaeger, Zipkin), but unfortunately LogStash doesn’t have plugins for any of them or for OpenTracing....</p></div><footer class=entry-footer><span title='2018-12-22 00:00:00 +0000 UTC'>December 22, 2018</span>&nbsp;·&nbsp;12 min</footer><a class=entry-link aria-label="post link to Code-free tracing with LogStash and Jaeger" href=https://andydote.co.uk/2018/12/22/serilog-elk-jaeger/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Microservices or Components</h2></header><div class=entry-content><p>One of the reasons people list for using MicroServices is that it helps enforce separation of concerns. This is usually achieved by adding a network boundary between the services. While this is useful, it’s not without costs; namely that you’ve added a set of new failure modes: the network. We can achieve the same separation of concerns within the same codebase if we put our minds to it. In fact, this is what Simon Brown calls a Modular Monolith, and DHH calls the Majestic Monolith....</p></div><footer class=entry-footer><span title='2018-10-28 00:00:00 +0000 UTC'>October 28, 2018</span>&nbsp;·&nbsp;6 min</footer><a class=entry-link aria-label="post link to Microservices or Components" href=https://andydote.co.uk/2018/10/28/microservices-or-components/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Feature Toggles with Consul</h2></header><div class=entry-content><p>Feature Toggles are a great way of helping to deliver working software, although there are a few things which could go wrong. See my talk Feature Toggles: The Good, The Bad and The Ugly for some interesting stories and insights on it!
I was talking with a colleague the other day about how you could go about implementing Feature Toggles in a centralised manner into an existing system, preferably with a little overhead as possible....</p></div><footer class=entry-footer><span title='2018-09-06 00:00:00 +0000 UTC'>September 6, 2018</span>&nbsp;·&nbsp;4 min</footer><a class=entry-link aria-label="post link to Feature Toggles with Consul" href=https://andydote.co.uk/2018/09/06/consul-feature-toggles/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Managing AppSettings in Consul</h2></header><div class=entry-content><p>Consul is a great utility to make running your microservice architecture very simple. Amongst other things, it provides Service Discovery, Health Checks, and Configuration. In this post, we are going to be looking at Configuration; not specifically how to read from Consul, but about how we put configuration data into Consul in the first place.
The usual flow for an application using Consul for configuration is as follows:
App Starts Fetches configuration from Consul Configures itself Registers in Consul for Service Discovery Ready Step 2 is very straightforward - you query the local instance of Consul’s HTTP API, and read the response into your configuration object (If you’re using Microsoft’s Configuration libraries on dotnet core, you can use the Consul....</p></div><footer class=entry-footer><span title='2018-08-07 00:00:00 +0000 UTC'>August 7, 2018</span>&nbsp;·&nbsp;4 min</footer><a class=entry-link aria-label="post link to Managing AppSettings in Consul" href=https://andydote.co.uk/2018/08/07/managing-consul-appsettings/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Locking Vault Down with Policies</h2></header><div class=entry-content><p>The final part of my Vault miniseries focuses on permissioning, which is provided by Vault’s Policies.
As everything in Vault is represented as a path, the policies DSL (Domain Specific Language) just needs to apply permissions to paths to lock things down. For example, to allow all operations on the cubbyhole secret engine, we would define this policy:
path "cubbyhole/*" { capabilities = ["create", "read", "update", "delete", "list"] } Vault comes with a default policy which allows token operations (such as looking up its own token info, releasing and renewing tokens), and cubbyhole access....</p></div><footer class=entry-footer><span title='2018-06-23 00:00:00 +0000 UTC'>June 23, 2018</span>&nbsp;·&nbsp;4 min</footer><a class=entry-link aria-label="post link to Locking Vault Down with Policies" href=https://andydote.co.uk/2018/06/23/vault-locking-it-down-with-policies/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Secure Communication with Vault</h2></header><div class=entry-content><p>I think Vault by Hashicorp is a great product - I particularly love how you can do dynamic secret generation (e.g for database connections). But how do you validate that the application requesting the secret is allowed to perform that action? How do you know it’s not someone or something impersonating your application?
While musing this at an airport the other day, my colleague Patrik sent me a link to a StackOverflow post about this very question...</p></div><footer class=entry-footer><span title='2018-06-22 00:00:00 +0000 UTC'>June 22, 2018</span>&nbsp;·&nbsp;5 min</footer><a class=entry-link aria-label="post link to Secure Communication with Vault" href=https://andydote.co.uk/2018/06/22/vault-secure-communication/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://andydote.co.uk/tags/microservices/page/2/>Next Page »</a></nav></footer></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>
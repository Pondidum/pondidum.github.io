<!doctype html><html lang=en dir=auto><head><meta name=generator content="Hugo 0.115.1"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Andy Dote</title><meta name=description content><meta name=author content><link rel=canonical href=https://andydote.co.uk/><link crossorigin=anonymous href=/assets/css/stylesheet.min.4ac25d88867f6882d86478d9b478a3d3efa1ed9e18f0bc5e432812301516cb28.css integrity="sha256-SsJdiIZ/aILYZHjZtHij0++h7Z4Y8LxeQygSMBUWyyg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/mermaid.min.725f44bd345b0a2a4043ca952b0863edd789e913cf0813a12bbdfe986fe87079.js integrity="sha256-cl9EvTRbCipAQ8qVKwhj7deJ6RPPCBOhK73+mG/ocHk="></script>
<script defer crossorigin=anonymous src=/js/tabs.min.2d019e9ee3574770ad4ecfd4f5f794739892195cb82a4e6383252b9074ab520c.js integrity="sha256-LQGenuNXR3CtTs/U9feUc5iSGVy4Kk5jgyUrkHSrUgw="></script>
<link rel=icon href=https://andydote.co.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://andydote.co.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://andydote.co.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://andydote.co.uk/apple-touch-icon.png><link rel=mask-icon href=https://andydote.co.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://andydote.co.uk/rss.xml><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Andy Dote"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://andydote.co.uk/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Andy Dote"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"Andy Dote","url":"https://andydote.co.uk","description":"","thumbnailUrl":"https://andydote.co.uk/favicon.ico","sameAs":[]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://andydote.co.uk accesskey=h title="Andy Dote (Alt + H)">Andy Dote</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://andydote.co.uk/archive title=Archive><span>Archive</span></a></li><li><a href=https://andydote.co.uk/talks title=Talks><span>Talks</span></a></li><li><a href=https://andydote.co.uk/notes title=Notes><span>Notes</span></a></li><li><a href=https://andydote.co.uk/tags title=Tags><span>Tags</span></a></li><li><a href=https://andydote.co.uk/contact title=Contact><span>Contact</span></a></li><li><a href=https://andydote.co.uk/rss.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-entry><header class=entry-header><h2>Using Vault as a Development CA</h2></header><div class=entry-content><p>Often when developing or testing some code, I need (or want) to use SSL, and one of the easiest ways to do that is to use Vault. However, it gets pretty annoying having to generate a new CA for each project, and import the CA cert into windows (less painful in Linux, but still annoying), especially as I forget which cert is in use, and accidentally clean up the wrong ones....</p></div><footer class=entry-footer><span title='2019-08-25 00:00:00 +0000 UTC'>August 25, 2019</span>&nbsp;·&nbsp;4 min</footer><a class=entry-link aria-label="post link to Using Vault as a Development CA" href=https://andydote.co.uk/2019/08/25/vault-development-ca/></a></article><article class=post-entry><header class=entry-header><h2>Architecture Decision Records</h2></header><div class=entry-content><p>This is a text version of a short talk (affectionately known as a “Coffee Bag”) I gave at work this week, on Architecture Design Records. You can see the slides here, but there isn’t a recording available, unfortunately.
It should be noted; these are not to replace full architecture diagrams; you should definitely still write C4 Models to cover the overall architecture. ADRs are for the details, such as serializer formats, convention-over-configuration details, number precisions for timings, or which metrics library is used and why....</p></div><footer class=entry-footer><span title='2019-06-29 00:00:00 +0000 UTC'>June 29, 2019</span>&nbsp;·&nbsp;8 min</footer><a class=entry-link aria-label="post link to Architecture Decision Records" href=https://andydote.co.uk/2019/06/29/architecture-decision-records/></a></article><article class=post-entry><header class=entry-header><h2>Canary Routing with Traefik in Nomad</h2></header><div class=entry-content><p>I wanted to implement canary routing for some HTTP services deployed via Nomad the other day, but rather than having the traffic split by weighting to the containers, I wanted to direct the traffic based on a header.
My first choice of tech was to use Fabio, but it only supports routing by URL prefix, and additionally with a route weight. While I was at JustDevOps in Poland, I heard about another router/loadbalancer which worked in a similar way to Fabio: Traefik....</p></div><footer class=entry-footer><span title='2019-06-23 00:00:00 +0000 UTC'>June 23, 2019</span>&nbsp;·&nbsp;8 min</footer><a class=entry-link aria-label="post link to Canary Routing with Traefik in Nomad" href=https://andydote.co.uk/2019/06/23/nomad-traefik-canary/></a></article><article class=post-entry><header class=entry-header><h2>Feature Toggles: Reducing Coupling</h2></header><div class=entry-content><p>One of the points I make in my Feature Toggles talk is that you shouldn’t be querying a toggle’s status all over your codebase. Ideally, each toggle gets checked in as few places as possible - preferably only one place. The advantage of doing this is that very little of your codebase needs to be coupled to the toggles (either the toggle itself or the library/system for managing toggles itself)....</p></div><footer class=entry-footer><span title='2019-06-11 00:00:00 +0000 UTC'>June 11, 2019</span>&nbsp;·&nbsp;6 min</footer><a class=entry-link aria-label="post link to Feature Toggles: Reducing Coupling" href=https://andydote.co.uk/2019/06/11/feature-toggles-reducing-coupling/></a></article><article class=post-entry><header class=entry-header><h2>Feature Toggles: Branch by Abstraction</h2></header><div class=entry-content><p>Recently, I was asked if I could provide an example of Branch By Abstraction when dealing with feature toggles. As this has come up a few times, I thought a blog post would be a good idea so I can refer others to it later too.
The Context As usual, this is some kind of backend (micro)service, and it will send email messages somehow. We will start with two implementations of message sending: the “current” version; which is synchronous, and a “new” version; which is async....</p></div><footer class=entry-footer><span title='2019-06-03 00:00:00 +0000 UTC'>June 3, 2019</span>&nbsp;·&nbsp;4 min</footer><a class=entry-link aria-label="post link to Feature Toggles: Branch by Abstraction" href=https://andydote.co.uk/2019/06/03/feature-toggles-branch-by-abstraction/></a></article><article class=post-entry><header class=entry-header><h2>Configuring Consul DNS Forwarding in Alpine Linux</h2></header><div class=entry-content><p>DEPRECATED - This has a race condition! Please see this post for an updated version which works!
Following on from the post the other day on setting up DNS forwarding to Consul with SystemD, I wanted also to show how to get Consul up and running under Alpine Linux, as it’s a little more awkward in some respects.
To start with, I am going to setup Consul as a service - I didn’t do this in the Ubuntu version, as there are plenty of useful articles about that already, but that is not the case with Alpine....</p></div><footer class=entry-footer><span title='2019-05-31 00:00:00 +0000 UTC'>May 31, 2019</span>&nbsp;·&nbsp;4 min</footer><a class=entry-link aria-label="post link to Configuring Consul DNS Forwarding in Alpine Linux" href=https://andydote.co.uk/2019/05/31/consul-dns-forwarding-alpine/></a></article><article class=post-entry><header class=entry-header><h2>Configuring Consul DNS Forwarding in Ubuntu 16.04</h2></header><div class=entry-content><p>DEPRECATED - This doesn’t work properly Please see this post for an updated version which works!
One of the advantages of using Consul for service discovery is that besides an HTTP API, you can also query it by DNS.
The DNS server is listening on port 8600 by default, and you can query both A records or SRV records from it. SRV records are useful as they contain additional properties (priority, weight and port), and you can get multiple records back from a single query, letting you do load balancing client side:...</p></div><footer class=entry-footer><span title='2019-05-29 00:00:00 +0000 UTC'>May 29, 2019</span>&nbsp;·&nbsp;4 min</footer><a class=entry-link aria-label="post link to Configuring Consul DNS Forwarding in Ubuntu 16.04" href=https://andydote.co.uk/2019/05/29/consul-dns-forwarding/></a></article><article class=post-entry><header class=entry-header><h2>Running a Secure RabbitMQ Cluster in Nomad</h2></header><div class=entry-content><p>Last time I wrote about running a RabbitMQ cluster in Nomad, one of the main pieces of feedback I received was about the (lack) of security of the setup, so I decided to revisit this, and write about how to launch as secure RabbitMQ node in Nomad.
The things I want to cover are:
Username and Password for the management UI Secure value for the Erlang Cookie SSL for Management and AMQP As usual, the demo repository with all the code is available if you’d rather just jump into that....</p></div><footer class=entry-footer><span title='2019-04-06 00:00:00 +0000 UTC'>April 6, 2019</span>&nbsp;·&nbsp;9 min</footer><a class=entry-link aria-label="post link to Running a Secure RabbitMQ Cluster in Nomad" href=https://andydote.co.uk/2019/04/06/nomad-rabbitmq-secure/></a></article><article class=post-entry><header class=entry-header><h2>Hyper-V, Docker, and Networking Drama</h2></header><div class=entry-content><p>I had a major problem a few hours before giving my Nomad: Kubernetes Without the Complexity talk this morning: the demo stopped working.
Now, the first thing to note is the entire setup of the demo is scripted, and the scripts hadn’t changed. The only thing I had done was restart the machine, and now things were breaking.
The Symptoms A docker container started inside the guest VMs with a port mapped to the machine’s public IP wasn’t resolvable outside the host....</p></div><footer class=entry-footer><span title='2019-03-22 00:00:00 +0000 UTC'>March 22, 2019</span>&nbsp;·&nbsp;3 min</footer><a class=entry-link aria-label="post link to Hyper-V, Docker, and Networking Drama" href=https://andydote.co.uk/2019/03/22/hyperv-networking/></a></article><article class=post-entry><header class=entry-header><h2>RabbitMQ clustering with Consul in Nomad</h2></header><div class=entry-content><p>Update If you want a secure version of this cluster, see Running a Secure RabbitMQ Cluster in Nomad.
RabbitMQ is the centre of a lot of micros service architectures, and while you can cluster it manually, it is a lot easier to use some of the auto clustering plugins, such as AWS (EC2), Consul, Etcd, or Kubernetes. As I like to use Nomad for container orchestration, I thought it would be a good idea to show how to cluster RabbitMQ when it is running in a Docker container, on an unknown host (i....</p></div><footer class=entry-footer><span title='2019-01-28 00:00:00 +0000 UTC'>January 28, 2019</span>&nbsp;·&nbsp;9 min</footer><a class=entry-link aria-label="post link to RabbitMQ clustering with Consul in Nomad" href=https://andydote.co.uk/2019/01/28/nomad-rabbitmq-consul-cluster/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://andydote.co.uk/page/3/>« Prev Page</a>
<a class=next href=https://andydote.co.uk/page/5/>Next Page »</a></nav></footer></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>
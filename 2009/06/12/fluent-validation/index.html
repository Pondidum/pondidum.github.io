<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Fluent Validation | Andy Dote</title><meta name=keywords content="design,c#"><meta name=description content="A few days a go i was going through my bookmarks, and came accross this post on the GetPaint.Net blog about using a fluent interface for parameter validation.
After reading the article, I tried the code out at home, and was very impressed. Not only does it read well, but also does not create any objects untill a piece of validation fails. Very nice.
However i wanted to use this at work, and this presented me with a problem."><meta name=author content><link rel=canonical href=https://andydote.co.uk/2009/06/12/fluent-validation/><link crossorigin=anonymous href=/assets/css/stylesheet.min.b4e19c453811e60acfec1f00c15ac2be1c53f6ab90187e684358ce7faaf48bab.css integrity="sha256-tOGcRTgR5grP7B8AwVrCvhxT9quQGH5oQ1jOf6r0i6s=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/mermaid.min.725f44bd345b0a2a4043ca952b0863edd789e913cf0813a12bbdfe986fe87079.js integrity="sha256-cl9EvTRbCipAQ8qVKwhj7deJ6RPPCBOhK73+mG/ocHk="></script>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://andydote.co.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://andydote.co.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://andydote.co.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://andydote.co.uk/apple-touch-icon.png><link rel=mask-icon href=https://andydote.co.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Fluent Validation"><meta property="og:description" content="A few days a go i was going through my bookmarks, and came accross this post on the GetPaint.Net blog about using a fluent interface for parameter validation.
After reading the article, I tried the code out at home, and was very impressed. Not only does it read well, but also does not create any objects untill a piece of validation fails. Very nice.
However i wanted to use this at work, and this presented me with a problem."><meta property="og:type" content="article"><meta property="og:url" content="https://andydote.co.uk/2009/06/12/fluent-validation/"><meta property="article:section" content="post"><meta property="article:published_time" content="2009-06-12T00:00:00+00:00"><meta property="article:modified_time" content="2009-06-12T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Fluent Validation"><meta name=twitter:description content="A few days a go i was going through my bookmarks, and came accross this post on the GetPaint.Net blog about using a fluent interface for parameter validation.
After reading the article, I tried the code out at home, and was very impressed. Not only does it read well, but also does not create any objects untill a piece of validation fails. Very nice.
However i wanted to use this at work, and this presented me with a problem."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://andydote.co.uk/post/"},{"@type":"ListItem","position":3,"name":"Fluent Validation","item":"https://andydote.co.uk/2009/06/12/fluent-validation/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Fluent Validation","name":"Fluent Validation","description":"A few days a go i was going through my bookmarks, and came accross this post on the GetPaint.Net blog about using a fluent interface for parameter validation.\nAfter reading the article, I tried the code out at home, and was very impressed. Not only does it read well, but also does not create any objects untill a piece of validation fails. Very nice.\nHowever i wanted to use this at work, and this presented me with a problem.","keywords":["design","c#"],"articleBody":"A few days a go i was going through my bookmarks, and came accross this post on the GetPaint.Net blog about using a fluent interface for parameter validation.\nAfter reading the article, I tried the code out at home, and was very impressed. Not only does it read well, but also does not create any objects untill a piece of validation fails. Very nice.\nHowever i wanted to use this at work, and this presented me with a problem. Work only has VS2005, which means no extension methods, which are the crux of how this validation method works.\nI spent a while trying to see if it was possible to keep the fluent interface and not instantiate any objects until something fails. In the end i settled for this method which only creates one object.\nPublic Class Validate Public Shared Function Begin() As ValidationExpression Return New ValidationExpression End Function Public Class ValidationExpression Private _validation As Validation = Nothing Friend Sub New() End Sub Public Function IsNotNull(Of T)(ByVal obj As T, ByVal name As String) As ValidationExpression If obj Is Nothing Then Init() _validation.AddException(New ArgumentNullException(name)) End If Return Me End Function Public Function IsPositive(ByVal value As Integer, ByVal name As String) As ValidationExpression If value \u003c 0 Then Init() _validation.AddException(New ArgumentOutOfRangeException(name, \"must be positive, but was \" \u0026 value.ToString)) End If Return Me End Function Public Function Check() As ValidationExpression If _validation Is Nothing Then Return Me End If If _validation.Exceptions.count = 1 Then Throw New ValidationException(_validation.Exceptions(0)) Else Throw New ValidationException(New MultiException(_validation.Exceptions)) End If End Function Private Sub Init() If _validation Is Nothing Then _validation = New Validation End If End Sub End Class End Class The rest of the code used is identical to Rick Brewster’s Article, so head over there to see it in all its (well written) glory.\n","wordCount":"300","inLanguage":"en","datePublished":"2009-06-12T00:00:00Z","dateModified":"2009-06-12T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://andydote.co.uk/2009/06/12/fluent-validation/"},"publisher":{"@type":"Organization","name":"Andy Dote","logo":{"@type":"ImageObject","url":"https://andydote.co.uk/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://andydote.co.uk accesskey=h title="Andy Dote (Alt + H)">Andy Dote</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://andydote.co.uk/archive title=Archive><span>Archive</span></a></li><li><a href=https://andydote.co.uk/talks title=Talks><span>Talks</span></a></li><li><a href=https://andydote.co.uk/notes title=Notes><span>Notes</span></a></li><li><a href=https://andydote.co.uk/tags title=Tags><span>Tags</span></a></li><li><a href=https://andydote.co.uk/contact title=Contact><span>Contact</span></a></li><li><a href=https://andydote.co.uk/rss.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Fluent Validation</h1><div class=post-meta><span title='2009-06-12 00:00:00 +0000 UTC'>June 12, 2009</span>&nbsp;·&nbsp;2 min</div></header><div class=post-content><p>A few days a go i was going through my bookmarks, and came accross <a href=http://blog.getpaint.net/2008/12/06/a-fluent-approach-to-c-parameter-validation/>this post</a> on the GetPaint.Net blog about using a fluent interface for parameter validation.</p><p>After reading the article, I tried the code out at home, and was very impressed. Not only does it read well, but also does not create any objects untill a piece of validation fails. Very nice.</p><p>However i wanted to use this at work, and this presented me with a problem. Work only has VS2005, which means no extension methods, which are the crux of how this validation method works.</p><p>I spent a while trying to see if it was possible to keep the fluent interface and not instantiate any objects until something fails. In the end i settled for this method which only creates one object.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb data-lang=vb><span style=display:flex><span><span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Class</span> <span style=color:#a6e22e>Validate</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Shared</span> <span style=color:#66d9ef>Function</span> <span style=color:#a6e22e>Begin</span>() <span style=color:#f92672>As</span> ValidationExpression
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>Return</span> <span style=color:#66d9ef>New</span> ValidationExpression
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Function</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Class</span> <span style=color:#a6e22e>ValidationExpression</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>Private</span> _validation <span style=color:#f92672>As</span> Validation <span style=color:#f92672>=</span> <span style=color:#66d9ef>Nothing</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>Friend</span> <span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>New</span>()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Sub</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Function</span> <span style=color:#a6e22e>IsNotNull</span>(<span style=color:#66d9ef>Of</span> T)(<span style=color:#66d9ef>ByVal</span> obj <span style=color:#f92672>As</span> T, <span style=color:#66d9ef>ByVal</span> name <span style=color:#f92672>As</span> <span style=color:#66d9ef>String</span>) <span style=color:#f92672>As</span> ValidationExpression
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>If</span> obj <span style=color:#f92672>Is</span> <span style=color:#66d9ef>Nothing</span> <span style=color:#66d9ef>Then</span>
</span></span><span style=display:flex><span>                Init()
</span></span><span style=display:flex><span>                _validation.AddException(<span style=color:#66d9ef>New</span> ArgumentNullException(name))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>If</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>Return</span> <span style=color:#66d9ef>Me</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Function</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Function</span> <span style=color:#a6e22e>IsPositive</span>(<span style=color:#66d9ef>ByVal</span> value <span style=color:#f92672>As</span> <span style=color:#66d9ef>Integer</span>, <span style=color:#66d9ef>ByVal</span> name <span style=color:#f92672>As</span> <span style=color:#66d9ef>String</span>) <span style=color:#f92672>As</span> ValidationExpression
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>If</span> value <span style=color:#f92672>&lt;</span> 0 <span style=color:#66d9ef>Then</span>
</span></span><span style=display:flex><span>                Init()
</span></span><span style=display:flex><span>                _validation.AddException(<span style=color:#66d9ef>New</span> ArgumentOutOfRangeException(name, <span style=color:#e6db74>&#34;must be positive, but was &#34;</span> <span style=color:#f92672>&amp;</span> value.ToString))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>If</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>Return</span> <span style=color:#66d9ef>Me</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Function</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Function</span> <span style=color:#a6e22e>Check</span>() <span style=color:#f92672>As</span> ValidationExpression
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>If</span> _validation <span style=color:#f92672>Is</span> <span style=color:#66d9ef>Nothing</span> <span style=color:#66d9ef>Then</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>Return</span> <span style=color:#66d9ef>Me</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>If</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>If</span> _validation.Exceptions.count <span style=color:#f92672>=</span> 1 <span style=color:#66d9ef>Then</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>Throw</span> <span style=color:#66d9ef>New</span> ValidationException(_validation.Exceptions(0))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>Else</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>Throw</span> <span style=color:#66d9ef>New</span> ValidationException(<span style=color:#66d9ef>New</span> MultiException(_validation.Exceptions))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>If</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Function</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>Private</span> <span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>Init</span>()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>If</span> _validation <span style=color:#f92672>Is</span> <span style=color:#66d9ef>Nothing</span> <span style=color:#66d9ef>Then</span>
</span></span><span style=display:flex><span>                _validation <span style=color:#f92672>=</span> <span style=color:#66d9ef>New</span> Validation
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>If</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Sub</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Class</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Class</span>
</span></span></code></pre></div><p>The rest of the code used is identical to Rick Brewster&rsquo;s Article, so <a href=http://blog.getpaint.net/2008/12/06/a-fluent-approach-to-c-parameter-validation/>head over there</a> to see it in all its (well written) glory.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://andydote.co.uk/tags/design/>design</a></li><li><a href=https://andydote.co.uk/tags/c#/>c#</a></li></ul><nav class=paginav><a class=prev href=https://andydote.co.uk/2009/06/19/coming-from-something-as-opposed-to-going-to-something/><span class=title>« Prev Page</span><br><span>Coming From Something as opposed to Going To Something</span></a>
<a class=next href=https://andydote.co.uk/2009/06/05/the-reading-list/><span class=title>Next Page »</span><br><span>The Reading List</span></a></nav></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Finally, I have used a Model View Controller! | Andy Dote</title><meta name=keywords content="design,code"><meta name=description content="Today I actually managed to use a Model View Controller in an application. I have been looking for an opportunity to use one fore a while, and have been reading a lot about them (Jeremy Miller&rsquo;s Build Your Own CAB Series has been a very good guide).
The type of MVC I like most (so far) is the Passive View type, where the View does almost nothing, and has no link to the Model:"><meta name=author content><link rel=canonical href=https://andydote.co.uk/2009/05/18/finally-i-have-used-a-model-view-controller/><link crossorigin=anonymous href=/assets/css/stylesheet.min.2b33c247bf6959372dd097f2cfdcd9f4d5019027cd9b1e28ae3d14c17c37ac00.css integrity="sha256-KzPCR79pWTct0Jfyz9zZ9NUBkCfNmx4orj0UwXw3rAA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/mermaid.min.725f44bd345b0a2a4043ca952b0863edd789e913cf0813a12bbdfe986fe87079.js integrity="sha256-cl9EvTRbCipAQ8qVKwhj7deJ6RPPCBOhK73+mG/ocHk="></script>
<script defer crossorigin=anonymous src=/js/tabs.min.2d019e9ee3574770ad4ecfd4f5f794739892195cb82a4e6383252b9074ab520c.js integrity="sha256-LQGenuNXR3CtTs/U9feUc5iSGVy4Kk5jgyUrkHSrUgw="></script>
<link rel=icon href=https://andydote.co.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://andydote.co.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://andydote.co.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://andydote.co.uk/apple-touch-icon.png><link rel=mask-icon href=https://andydote.co.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Finally, I have used a Model View Controller!"><meta property="og:description" content="Today I actually managed to use a Model View Controller in an application. I have been looking for an opportunity to use one fore a while, and have been reading a lot about them (Jeremy Miller&rsquo;s Build Your Own CAB Series has been a very good guide).
The type of MVC I like most (so far) is the Passive View type, where the View does almost nothing, and has no link to the Model:"><meta property="og:type" content="article"><meta property="og:url" content="https://andydote.co.uk/2009/05/18/finally-i-have-used-a-model-view-controller/"><meta property="article:section" content="post"><meta property="article:published_time" content="2009-05-18T00:00:00+00:00"><meta property="article:modified_time" content="2009-05-18T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Finally, I have used a Model View Controller!"><meta name=twitter:description content="Today I actually managed to use a Model View Controller in an application. I have been looking for an opportunity to use one fore a while, and have been reading a lot about them (Jeremy Miller&rsquo;s Build Your Own CAB Series has been a very good guide).
The type of MVC I like most (so far) is the Passive View type, where the View does almost nothing, and has no link to the Model:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://andydote.co.uk/post/"},{"@type":"ListItem","position":3,"name":"Finally, I have used a Model View Controller!","item":"https://andydote.co.uk/2009/05/18/finally-i-have-used-a-model-view-controller/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Finally, I have used a Model View Controller!","name":"Finally, I have used a Model View Controller!","description":"Today I actually managed to use a Model View Controller in an application. I have been looking for an opportunity to use one fore a while, and have been reading a lot about them (Jeremy Miller\u0026rsquo;s Build Your Own CAB Series has been a very good guide).\nThe type of MVC I like most (so far) is the Passive View type, where the View does almost nothing, and has no link to the Model:","keywords":["design","code"],"articleBody":"Today I actually managed to use a Model View Controller in an application. I have been looking for an opportunity to use one fore a while, and have been reading a lot about them (Jeremy Miller’s Build Your Own CAB Series has been a very good guide).\nThe type of MVC I like most (so far) is the Passive View type, where the View does almost nothing, and has no link to the Model:\nImage Source: Microsoft\nThere are two main ways of wiring your View to the Presenter/Controller: Events and Interfaces. The advantage of using an Interface is that they are easier to test (using Rhino Mocks), but as work does not do unit testing (I’m working on it!), that didn’t matter too much. I used events in this case simply because I prefer them.\nAs we already have a data layer, and I was just designing a form to expose some functionality I didn’t really use a Model either (unless a DAL counts, and I’m not sure it does).\nIn the end my Controller and Form looked something like this (much snipped, but you get the idea):\nPublic Class SearchController Private _control As ISynchronizeInvoke Private Delegate Sub OnSearchDelegate(ByVal sender As Object, ByVal e As SearchEventArgs) Public Event SearchStarted(ByVal sender As Object, ByVal e As SearchEventArgs) Public Event SearchProgress(ByVal sender As Object, ByVal e As SearchEventArgs) Public Event SearchFinished(ByVal sender As Object, ByVal e As SearchEventArgs) Public Sub New(ByVal parent As ISynchronizeInvoke) _control = parent End Sub Private Sub OnSearchStarted(ByVal sender As Object, ByVal e As SearchEventArgs) If _control.InvokeRequired Then _control.Invoke(New OnSearchDelegate(AddressOf OnSearchStarted), New Object() {sender, e}) Else RaiseEvent SearchStarted(sender, e) End If End Sub 'snip for other events... Public Sub SetPhrase(ByVal phrase As String) '... End Sub Public Sub Search() OnSearchStarted(Me, New SearchEventArgs()) '... End Sub '... End Class Public Class frmSearch Private _controller as new SearchController(Me) Private Sub btnSearch_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) _controller.SetPhrase(txtInput.Text.Trim) End Sub Private Sub controller_SearchStarted(ByVal sender As Object, ByVal e As SearchEventArgs) '... End Sub '... End Class Hopefully I will get the opportunity to use MVC/MVP more completely in the future.\n","wordCount":"352","inLanguage":"en","datePublished":"2009-05-18T00:00:00Z","dateModified":"2009-05-18T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://andydote.co.uk/2009/05/18/finally-i-have-used-a-model-view-controller/"},"publisher":{"@type":"Organization","name":"Andy Dote","logo":{"@type":"ImageObject","url":"https://andydote.co.uk/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://andydote.co.uk accesskey=h title="Andy Dote (Alt + H)">Andy Dote</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://andydote.co.uk/archive title=Archive><span>Archive</span></a></li><li><a href=https://andydote.co.uk/talks title=Talks><span>Talks</span></a></li><li><a href=https://andydote.co.uk/notes title=Notes><span>Notes</span></a></li><li><a href=https://andydote.co.uk/tags title=Tags><span>Tags</span></a></li><li><a href=https://andydote.co.uk/contact title=Contact><span>Contact</span></a></li><li><a href=https://andydote.co.uk/rss.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Finally, I have used a Model View Controller!</h1><div class=post-meta><span title='2009-05-18 00:00:00 +0000 UTC'>May 18, 2009</span>&nbsp;·&nbsp;2 min</div></header><div class=post-content><p>Today I actually managed to use a Model View Controller in an application. I have been looking for an opportunity to use one fore a while, and have been reading a lot about them (Jeremy Miller&rsquo;s <a href=http://codebetter.com/blogs/jeremy.miller/archive/2007/07/25/the-build-your-own-cab-series-table-of-contents.aspx>Build Your Own CAB Series</a> has been a very good guide).</p><p>The type of MVC I like most (so far) is the <a href=http://martinfowler.com/eaaDev/PassiveScreen.html>Passive View</a> type, where the View does almost nothing, and has no link to the Model:</p><p><img loading=lazy src=passive-view.png alt="&amp;ldquo;Passive View&amp;rdquo; Model View Presenter"><br>Image Source: <a href=http://msdn.microsoft.com/en-us/library/cc304760.aspx>Microsoft</a></p><p>There are two main ways of wiring your View to the Presenter/Controller: Events and Interfaces. The advantage of using an Interface is that they are easier to test (using <a href=http://hibernatingrhinos.com/oss/rhino-mocks>Rhino Mocks</a>), but as work does not do unit testing (I&rsquo;m working on it!), that didn&rsquo;t matter too much. I used events in this case simply because I prefer them.</p><p>As we already have a data layer, and I was just designing a form to expose some functionality I didn&rsquo;t really use a Model either (unless a DAL counts, and I&rsquo;m not sure it does).</p><p>In the end my Controller and Form looked something like this (much snipped, but you get the idea):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb data-lang=vb><span style=display:flex><span> <span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Class</span> <span style=color:#a6e22e>SearchController</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Private</span> _control <span style=color:#f92672>As</span> ISynchronizeInvoke
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Private</span> <span style=color:#66d9ef>Delegate</span> <span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>OnSearchDelegate</span>(<span style=color:#66d9ef>ByVal</span> sender <span style=color:#f92672>As</span> <span style=color:#66d9ef>Object</span>, <span style=color:#66d9ef>ByVal</span> e <span style=color:#f92672>As</span> SearchEventArgs)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Event</span> SearchStarted(<span style=color:#66d9ef>ByVal</span> sender <span style=color:#f92672>As</span> <span style=color:#66d9ef>Object</span>, <span style=color:#66d9ef>ByVal</span> e <span style=color:#f92672>As</span> SearchEventArgs)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Event</span> SearchProgress(<span style=color:#66d9ef>ByVal</span> sender <span style=color:#f92672>As</span> <span style=color:#66d9ef>Object</span>, <span style=color:#66d9ef>ByVal</span> e <span style=color:#f92672>As</span> SearchEventArgs)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Event</span> SearchFinished(<span style=color:#66d9ef>ByVal</span> sender <span style=color:#f92672>As</span> <span style=color:#66d9ef>Object</span>, <span style=color:#66d9ef>ByVal</span> e <span style=color:#f92672>As</span> SearchEventArgs)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>New</span>(<span style=color:#66d9ef>ByVal</span> parent <span style=color:#f92672>As</span> ISynchronizeInvoke)
</span></span><span style=display:flex><span>        _control <span style=color:#f92672>=</span> parent
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Sub</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Private</span> <span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>OnSearchStarted</span>(<span style=color:#66d9ef>ByVal</span> sender <span style=color:#f92672>As</span> <span style=color:#66d9ef>Object</span>, <span style=color:#66d9ef>ByVal</span> e <span style=color:#f92672>As</span> SearchEventArgs)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>If</span> _control.InvokeRequired <span style=color:#66d9ef>Then</span>
</span></span><span style=display:flex><span>            _control.Invoke(<span style=color:#66d9ef>New</span> OnSearchDelegate(<span style=color:#f92672>AddressOf</span> OnSearchStarted), <span style=color:#66d9ef>New</span> <span style=color:#66d9ef>Object</span>() {sender, e})
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>Else</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>RaiseEvent</span> SearchStarted(sender, e)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>If</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Sub</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&#39;snip for other events...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>SetPhrase</span>(<span style=color:#66d9ef>ByVal</span> phrase <span style=color:#f92672>As</span> <span style=color:#66d9ef>String</span>)
</span></span><span style=display:flex><span>        <span style=color:#75715e>&#39;...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Sub</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>Search</span>()
</span></span><span style=display:flex><span>        OnSearchStarted(<span style=color:#66d9ef>Me</span>, <span style=color:#66d9ef>New</span> SearchEventArgs())
</span></span><span style=display:flex><span>        <span style=color:#75715e>&#39;...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Sub</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&#39;...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Class</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Class</span> <span style=color:#a6e22e>frmSearch</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Private</span> _controller <span style=color:#f92672>as</span> <span style=color:#66d9ef>new</span> SearchController(<span style=color:#66d9ef>Me</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Private</span> <span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>btnSearch_Click</span>(<span style=color:#66d9ef>ByVal</span> sender <span style=color:#f92672>As</span> System.Object, <span style=color:#66d9ef>ByVal</span> e <span style=color:#f92672>As</span> System.EventArgs)
</span></span><span style=display:flex><span>        _controller.SetPhrase(txtInput.Text.Trim)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Sub</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>Private</span> <span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>controller_SearchStarted</span>(<span style=color:#66d9ef>ByVal</span> sender <span style=color:#f92672>As</span> <span style=color:#66d9ef>Object</span>, <span style=color:#66d9ef>ByVal</span> e <span style=color:#f92672>As</span> SearchEventArgs)
</span></span><span style=display:flex><span>        <span style=color:#75715e>&#39;...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Sub</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&#39;...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Class</span>
</span></span></code></pre></div><p>Hopefully I will get the opportunity to use MVC/MVP more completely in the future.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://andydote.co.uk/tags/design/>design</a></li><li><a href=https://andydote.co.uk/tags/code/>code</a></li></ul><nav class=paginav><a class=prev href=https://andydote.co.uk/2009/05/19/using-laziness/><span class=title>« Prev Page</span><br><span>Using Laziness</span></a>
<a class=next href=https://andydote.co.uk/2009/05/15/sql-like-statement/><span class=title>Next Page »</span><br><span>SQL Like statement</span></a></nav></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Functionality and Seperation of Concerns | Andy Dote</title>
<meta name=keywords content="design,c#"><meta name=description content="When I am writing a winform in an MVP style, I often wonder how far to go with the separation. Say I have the following situation:
A small form which should display a list of messages, and allow the user to select which ones they want processed. It processes each message in turn. If a message has more than one attachment, a dialog is shown to ask the user to select which attachment should be used for that message."><meta name=author content><link rel=canonical href=https://andydote.co.uk/2009/12/15/functionality-and-seperation-of-concerns/><link crossorigin=anonymous href=/assets/css/stylesheet.min.d3aaf8cdcec9a6487824ab95cadf08232ec362e7ba510c6b742973d16ef5b72e.css integrity="sha256-06r4zc7Jpkh4JKuVyt8IIy7DYue6UQxrdClz0W71ty4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/mermaid.min.c6a36963ab47314b3d95fe85a9385337e1ef8eb1c2194eecb86f178d492ab666.js integrity="sha256-xqNpY6tHMUs9lf6FqThTN+HvjrHCGU7suG8XjUkqtmY="></script><script defer crossorigin=anonymous src=/js/tabs.min.2d019e9ee3574770ad4ecfd4f5f794739892195cb82a4e6383252b9074ab520c.js integrity="sha256-LQGenuNXR3CtTs/U9feUc5iSGVy4Kk5jgyUrkHSrUgw="></script><link rel=icon href=https://andydote.co.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://andydote.co.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://andydote.co.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://andydote.co.uk/apple-touch-icon.png><link rel=mask-icon href=https://andydote.co.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Functionality and Seperation of Concerns"><meta property="og:description" content="When I am writing a winform in an MVP style, I often wonder how far to go with the separation. Say I have the following situation:
A small form which should display a list of messages, and allow the user to select which ones they want processed. It processes each message in turn. If a message has more than one attachment, a dialog is shown to ask the user to select which attachment should be used for that message."><meta property="og:type" content="article"><meta property="og:url" content="https://andydote.co.uk/2009/12/15/functionality-and-seperation-of-concerns/"><meta property="article:section" content="post"><meta property="article:published_time" content="2009-12-15T00:00:00+00:00"><meta property="article:modified_time" content="2009-12-15T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Functionality and Seperation of Concerns"><meta name=twitter:description content="When I am writing a winform in an MVP style, I often wonder how far to go with the separation. Say I have the following situation:
A small form which should display a list of messages, and allow the user to select which ones they want processed. It processes each message in turn. If a message has more than one attachment, a dialog is shown to ask the user to select which attachment should be used for that message."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://andydote.co.uk/post/"},{"@type":"ListItem","position":3,"name":"Functionality and Seperation of Concerns","item":"https://andydote.co.uk/2009/12/15/functionality-and-seperation-of-concerns/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Functionality and Seperation of Concerns","name":"Functionality and Seperation of Concerns","description":"When I am writing a winform in an MVP style, I often wonder how far to go with the separation. Say I have the following situation:\nA small form which should display a list of messages, and allow the user to select which ones they want processed. It processes each message in turn. If a message has more than one attachment, a dialog is shown to ask the user to select which attachment should be used for that message.","keywords":["design","c#"],"articleBody":"When I am writing a winform in an MVP style, I often wonder how far to go with the separation. Say I have the following situation:\nA small form which should display a list of messages, and allow the user to select which ones they want processed. It processes each message in turn. If a message has more than one attachment, a dialog is shown to ask the user to select which attachment should be used for that message.\nNow while this is fairly simple, my interface for the message dialog looks like this:\nPublic Interface IMessageSelector Event Submit() Event Cancel() WriteOnly Property Messages() As IList(Of MessageData) ReadOnly Property Selected() As IList(Of String) ReadOnly Property AttachmentView() As IAttachmentScreen Sub ShowScreen() Sub CloseScreen() Sub DisplayWarning(ByVal text As String) End Interface In the form I have (roughly) the following:\nPublic Class frmMessages Implements IMessageSelector '...' Public WriteOnly Property Messages() As IList(Of MessageData) Implements IMessageSelector.Messages Set(ByVal value As IList(Of MessageData)) For Each d As MessageData In value Dim r As Grid.Row = grid.Rows.Add r(\"id\") = d.ID r(\"subject\") = d.Subject r(\"from\") = d.Sender r(\"received\") = d.SendDate Next flx.AutoSizeCols() End Set End Property Public ReadOnly Property Selected() As IList(Of String) Implements IMessageSelector.Selected Get Dim result As New List(Of String) For i As Integer = 1 To grid.Rows.Count - 1 If Convert.ToBoolean(grid(i, \"selected\")) Then result.Add(grid(i, \"id\").ToString) End If Next Return result End Get End Property End Class Now I think that this is ok. There is not logic as such in the population property, and the Selected property just determines which rows have had their checkboxes ticked.\nHowever it has been requested that I add a ‘Select All/None’ checkbox to the form. Where do I add the code for this? As they want a checkbox to tick or detick its not as trivial as it could be. If it were separate buttons, I could just use a for loop in each setting the values to True or False. A checkbox however has some uncertainties:\nChecking the master checkbox should make all rows checked. Fine. DeChecking the master checkbox should make all rows unchecked. Also fine. Checking one row when none are checked should do what to the master checkbox? DeChecking one row when all are checked should do what to the master checkbox? 25%/50%/75% of rows are checked, what does the master checkbox look like? Some rows are checked. What happens when the checkbox is clicked? So many questions for such a simple looking feature. With so many possibilities for it maybe it should go into the presenter/interface? At least it’s testable then. Maybe a separate controller for it as it’s not really anything to do with the purpose of the form?\nIf anyone knows of answers to this I would be very interested to hear them.\n","wordCount":"461","inLanguage":"en","datePublished":"2009-12-15T00:00:00Z","dateModified":"2009-12-15T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://andydote.co.uk/2009/12/15/functionality-and-seperation-of-concerns/"},"publisher":{"@type":"Organization","name":"Andy Dote","logo":{"@type":"ImageObject","url":"https://andydote.co.uk/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://andydote.co.uk accesskey=h title="Andy Dote (Alt + H)">Andy Dote</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://andydote.co.uk/archive title=Archive><span>Archive</span></a></li><li><a href=https://andydote.co.uk/talks title=Talks><span>Talks</span></a></li><li><a href=https://andydote.co.uk/notes title=Notes><span>Notes</span></a></li><li><a href=https://andydote.co.uk/tags title=Tags><span>Tags</span></a></li><li><a href=https://andydote.co.uk/contact title=Contact><span>Contact</span></a></li><li><a href=https://andydote.co.uk/rss.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Functionality and Seperation of Concerns</h1><div class=post-meta>&lt;span title='2009-12-15 00:00:00 +0000 UTC'>December 15, 2009&lt;/span>&amp;nbsp;·&amp;nbsp;3 min</div></header><div class=post-content><p>When I am writing a winform in an MVP style, I often wonder how far to go with the separation. Say I have the following situation:</p><p>A small form which should display a list of messages, and allow the user to select which ones they want processed. It processes each message in turn. If a message has more than one attachment, a dialog is shown to ask the user to select which attachment should be used for that message.</p><p>Now while this is fairly simple, my interface for the message dialog looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb data-lang=vb><span style=display:flex><span><span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Interface</span> IMessageSelector
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Event</span> Submit()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Event</span> Cancel()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>WriteOnly</span> <span style=color:#66d9ef>Property</span> <span style=color:#a6e22e>Messages</span>() <span style=color:#f92672>As</span> IList(<span style=color:#66d9ef>Of</span> MessageData)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>ReadOnly</span> <span style=color:#66d9ef>Property</span> <span style=color:#a6e22e>Selected</span>() <span style=color:#f92672>As</span> IList(<span style=color:#66d9ef>Of</span> <span style=color:#66d9ef>String</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>ReadOnly</span> <span style=color:#66d9ef>Property</span> <span style=color:#a6e22e>AttachmentView</span>() <span style=color:#f92672>As</span> IAttachmentScreen
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>ShowScreen</span>()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>CloseScreen</span>()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>DisplayWarning</span>(<span style=color:#66d9ef>ByVal</span> text <span style=color:#f92672>As</span> <span style=color:#66d9ef>String</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Interface</span>
</span></span></code></pre></div><p>In the form I have (roughly) the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb data-lang=vb><span style=display:flex><span><span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Class</span> <span style=color:#a6e22e>frmMessages</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Implements</span> IMessageSelector
</span></span><span style=display:flex><span>	<span style=color:#75715e>&#39;...&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>WriteOnly</span> <span style=color:#66d9ef>Property</span> <span style=color:#a6e22e>Messages</span>() <span style=color:#f92672>As</span> IList(<span style=color:#66d9ef>Of</span> MessageData) <span style=color:#66d9ef>Implements</span> IMessageSelector.Messages
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>Set</span>(<span style=color:#66d9ef>ByVal</span> value <span style=color:#f92672>As</span> IList(<span style=color:#66d9ef>Of</span> MessageData))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>For</span> <span style=color:#66d9ef>Each</span> d <span style=color:#f92672>As</span> MessageData <span style=color:#f92672>In</span> value
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>Dim</span> r <span style=color:#f92672>As</span> Grid.Row <span style=color:#f92672>=</span> grid.Rows.Add
</span></span><span style=display:flex><span>				r(<span style=color:#e6db74>&#34;id&#34;</span>) <span style=color:#f92672>=</span> d.ID
</span></span><span style=display:flex><span>				r(<span style=color:#e6db74>&#34;subject&#34;</span>) <span style=color:#f92672>=</span> d.Subject
</span></span><span style=display:flex><span>				r(<span style=color:#e6db74>&#34;from&#34;</span>) <span style=color:#f92672>=</span> d.Sender
</span></span><span style=display:flex><span>				r(<span style=color:#e6db74>&#34;received&#34;</span>) <span style=color:#f92672>=</span> d.SendDate
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>Next</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			flx.AutoSizeCols()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Set</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Property</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>ReadOnly</span> <span style=color:#66d9ef>Property</span> <span style=color:#a6e22e>Selected</span>() <span style=color:#f92672>As</span> IList(<span style=color:#66d9ef>Of</span> <span style=color:#66d9ef>String</span>) <span style=color:#66d9ef>Implements</span> IMessageSelector.Selected
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>Get</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>Dim</span> result <span style=color:#f92672>As</span> <span style=color:#66d9ef>New</span> List(<span style=color:#66d9ef>Of</span> <span style=color:#66d9ef>String</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>For</span> i <span style=color:#f92672>As</span> <span style=color:#66d9ef>Integer</span> <span style=color:#f92672>=</span> 1 <span style=color:#66d9ef>To</span> grid.Rows.Count <span style=color:#f92672>-</span> 1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>If</span> Convert.ToBoolean(grid(i, <span style=color:#e6db74>&#34;selected&#34;</span>)) <span style=color:#66d9ef>Then</span>
</span></span><span style=display:flex><span>					result.Add(grid(i, <span style=color:#e6db74>&#34;id&#34;</span>).ToString)
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>If</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>Next</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>Return</span> result
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Get</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Property</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Class</span>
</span></span></code></pre></div><p>Now I think that this is ok. There is not logic as such in the population property, and the Selected property just determines which rows have had their checkboxes ticked.</p><p>However it has been requested that I add a &lsquo;Select All/None&rsquo; checkbox to the form. Where do I add the code for this? As they want a checkbox to tick or detick its not as trivial as it could be. If it were separate buttons, I could just use a for loop in each setting the values to True or False. A checkbox however has some uncertainties:</p><ul><li>Checking the master checkbox should make all rows checked. Fine.</li><li>DeChecking the master checkbox should make all rows unchecked. Also fine.</li><li>Checking one row when none are checked should do what to the master checkbox?</li><li>DeChecking one row when all are checked should do what to the master checkbox?</li><li>25%/50%/75% of rows are checked, what does the master checkbox look like?</li><li>Some rows are checked. What happens when the checkbox is clicked?</li></ul><p>So many questions for such a simple looking feature. With so many possibilities for it maybe it should go into the presenter/interface? At least it&rsquo;s testable then. Maybe a separate controller for it as it&rsquo;s not really anything to do with the <em>purpose</em> of the form?</p><p>If anyone knows of answers to this I would be very interested to hear them.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://andydote.co.uk/tags/design/>design</a></li><li><a href=https://andydote.co.uk/tags/c#/>c#</a></li></ul><nav class=paginav><a class=prev href=https://andydote.co.uk/2009/12/16/thanks-google-for-solving-my-problem/><span class=title>« Prev Page</span><br><span>Thanks Google for solving my problem!</span>
</a><a class=next href=https://andydote.co.uk/2009/10/07/software-fuzzying-maybe/><span class=title>Next Page »</span><br><span>Software Fuzzying maybe?</span></a></nav></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
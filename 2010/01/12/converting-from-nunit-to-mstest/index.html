<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Converting from NUnit to MSTest | Andy Dote</title><meta name=keywords content="c#"><meta name=description content="While this is not something I personally would want to do, we (for whatever reason&mldr;) are to use MSTest at work (I think it is due to the whole &ldquo;Its Microsoft, so it&rsquo;s supported&rdquo; argument).
Now as no one else on the team does any kind of unit testing (serious), the only test projects we have are written by me, on the quiet before being told if I wanted to unit test then use MSTest."><meta name=author content><link rel=canonical href=https://andydote.co.uk/2010/01/12/converting-from-nunit-to-mstest/><link crossorigin=anonymous href=/assets/css/stylesheet.min.ea821116adbd94ff8c04bf7745204429750a1079f16951db0415b837fc273249.css integrity="sha256-6oIRFq29lP+MBL93RSBEKXUKEHnxaVHbBBW4N/wnMkk=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/mermaid.min.725f44bd345b0a2a4043ca952b0863edd789e913cf0813a12bbdfe986fe87079.js integrity="sha256-cl9EvTRbCipAQ8qVKwhj7deJ6RPPCBOhK73+mG/ocHk="></script>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://andydote.co.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://andydote.co.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://andydote.co.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://andydote.co.uk/apple-touch-icon.png><link rel=mask-icon href=https://andydote.co.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Converting from NUnit to MSTest"><meta property="og:description" content="While this is not something I personally would want to do, we (for whatever reason&mldr;) are to use MSTest at work (I think it is due to the whole &ldquo;Its Microsoft, so it&rsquo;s supported&rdquo; argument).
Now as no one else on the team does any kind of unit testing (serious), the only test projects we have are written by me, on the quiet before being told if I wanted to unit test then use MSTest."><meta property="og:type" content="article"><meta property="og:url" content="https://andydote.co.uk/2010/01/12/converting-from-nunit-to-mstest/"><meta property="article:section" content="post"><meta property="article:published_time" content="2010-01-12T00:00:00+00:00"><meta property="article:modified_time" content="2010-01-12T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Converting from NUnit to MSTest"><meta name=twitter:description content="While this is not something I personally would want to do, we (for whatever reason&mldr;) are to use MSTest at work (I think it is due to the whole &ldquo;Its Microsoft, so it&rsquo;s supported&rdquo; argument).
Now as no one else on the team does any kind of unit testing (serious), the only test projects we have are written by me, on the quiet before being told if I wanted to unit test then use MSTest."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://andydote.co.uk/post/"},{"@type":"ListItem","position":3,"name":"Converting from NUnit to MSTest","item":"https://andydote.co.uk/2010/01/12/converting-from-nunit-to-mstest/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Converting from NUnit to MSTest","name":"Converting from NUnit to MSTest","description":"While this is not something I personally would want to do, we (for whatever reason\u0026hellip;) are to use MSTest at work (I think it is due to the whole \u0026ldquo;Its Microsoft, so it\u0026rsquo;s supported\u0026rdquo; argument).\nNow as no one else on the team does any kind of unit testing (serious), the only test projects we have are written by me, on the quiet before being told if I wanted to unit test then use MSTest.","keywords":["c#"],"articleBody":"While this is not something I personally would want to do, we (for whatever reason…) are to use MSTest at work (I think it is due to the whole “Its Microsoft, so it’s supported” argument).\nNow as no one else on the team does any kind of unit testing (serious), the only test projects we have are written by me, on the quiet before being told if I wanted to unit test then use MSTest. So onto the point of this article.\nWhen you create a project for tests with nunit, you just create a Class Library, add a reference to nunit (and Rhino.Mocks of course), build it and run with your preferred method (I like TDD.Net, but that involves paying for at work…so no go there).\nWhen you want to do tests with MSTest, you just create a Test Project and start writing tests. On closer inspection, it’s just a Class Library with a reference to Microsoft.VisualStudio.QualityTools.UnitTestFramework. So converting one to the other should be easy, right?\nWell not quite. While there is nothing in the GUI to suggest so, you need to modify the csproj/vbproj file to get it to work. This post on MSDN, had all the details, but in the interest of having things in more than one place (not very DRY I will admit, but there), here are the steps:\nRemove Reference to Nunit.Core \u0026 Nunit.Framework Add Reference to Microsoft.VisualStudio.QualityTools.UnitTestFramework Find and Replace: using NUnit.Framework; with using Microsoft.VisualStudio.TestTools.UnitTesting; (I actually use a project level import, so I skip this) [TestFixture] -\u003e [TestClass] [Test] -\u003e [TestMethod] [SetUp] -\u003e [TestInitialize] [TearDown] -\u003e [TestCleanup] [TestFixtureSetUp] -\u003e [ClassInitialize] [TestFixtureTearDown] -\u003e [ClassCleanup] Change your Asserts: Assert.Greater(x, y) -\u003e Assert.IsTrue(x \u003e y) Assert.AreEqual(x, Is.EqualTo(y).IgnoreCase) -\u003e Assert.AreEqual(x, y, True) The ‘hidden’ part. In your project file, locate (not the one specifying debug|release settings), and add the following to it: 512 *.csproj files add: {3AC096D0-A1C2-E12C-1390-A8335801FDAB};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC} *.vbproj files add: {3AC096D0-A1C2-E12C-1390-A8335801FDAB};{F184B08F-C81C-45F6-A57F-5ABD9991F28F} This was all I had to do to get our (my) tests running again under MSTest. Except they didn’t run, with the lovely error of:\nThe location of the file or directory ‘D:\\Projects\\Dev\\SDK\\Rhino.Mocks.dll’ is not trusted.\nThat’s odd, the file is on my hard disk, its not a network share, so what’s the problem? Right click on Rhino.Mocks.dll and:\nClick the Unblock button, hit Apply, re-run the tests. All Working now :)\nThere are a few other points mentioned on the MSDN post too which you may run into:\nIf you have relied on NUnit TestFixtureSetup and TestFixtureTearDown methods to do non-static things, will have to move functions in the former to a constructor and the latter to a destructor. In MSTest, both of these methods must be declared as static.\nIf you are relying on AppDomain.CurrentDomain.BaseDirectory to get the root directory, your test will break. The fix is explained at http://www.ademiller.com/blogs/tech/2008/01/gotchas-mstest-appdomain-changes-in-vs-2008/.\nBasically, you need to set your BaseDirectory in your MSTest TestClass constructor like this:\nstring currDir = Environment.CurrentDirectory.Substring(0, Environment.CurrentDirectory.IndexOf(\"TestResults\")); AppDomain.CurrentDomain.SetData(\"APPBASE\", currDir); MSTest launches each test method in a separate STA thread instead of the MTA thread you may be expecting. This probably won’t give you any problems.\nHope that helps everyone who has to do this kind of conversion.\n","wordCount":"528","inLanguage":"en","datePublished":"2010-01-12T00:00:00Z","dateModified":"2010-01-12T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://andydote.co.uk/2010/01/12/converting-from-nunit-to-mstest/"},"publisher":{"@type":"Organization","name":"Andy Dote","logo":{"@type":"ImageObject","url":"https://andydote.co.uk/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://andydote.co.uk accesskey=h title="Andy Dote (Alt + H)">Andy Dote</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://andydote.co.uk/archive title=Archive><span>Archive</span></a></li><li><a href=https://andydote.co.uk/talks title=Talks><span>Talks</span></a></li><li><a href=https://andydote.co.uk/notes title=Notes><span>Notes</span></a></li><li><a href=https://andydote.co.uk/tags title=Tags><span>Tags</span></a></li><li><a href=https://andydote.co.uk/contact title=Contact><span>Contact</span></a></li><li><a href=https://andydote.co.uk/rss.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Converting from NUnit to MSTest</h1><div class=post-meta><span title='2010-01-12 00:00:00 +0000 UTC'>January 12, 2010</span>&nbsp;·&nbsp;3 min</div></header><div class=post-content><p>While this is not something I personally would want to do, we (for whatever reason&mldr;) are to use MSTest at work (I think it is due to the whole &ldquo;Its Microsoft, so it&rsquo;s supported&rdquo; argument).</p><p>Now as no one else on the team does any kind of unit testing (serious), the only test projects we have are written by me, on the quiet before being told if I wanted to unit test then use MSTest. So onto the point of this article.</p><p>When you create a project for tests with nunit, you just create a <code>Class Library</code>, add a reference to nunit (and Rhino.Mocks of course), build it and run with your preferred method (I like TDD.Net, but that involves paying for at work&mldr;so no go there).</p><p>When you want to do tests with MSTest, you just create a Test Project and start writing tests. On closer inspection, it&rsquo;s just a <code>Class Library</code> with a reference to <code>Microsoft.VisualStudio.QualityTools.UnitTestFramework</code>. So converting one to the other should be easy, right?</p><p>Well not quite. While there is nothing in the GUI to suggest so, you need to modify the csproj/vbproj file to get it to work. This post on <a href=http://social.msdn.microsoft.com/Forums/en/vststest/thread/433e4860-b61f-44fd-bef9-a569fb32d244>MSDN</a>, had all the details, but in the interest of having things in more than one place (not very DRY I will admit, but there), here are the steps:</p><ol><li>Remove Reference to Nunit.Core & Nunit.Framework</li><li>Add Reference to Microsoft.VisualStudio.QualityTools.UnitTestFramework</li><li>Find and Replace:</li></ol><ul><li><code>using NUnit.Framework;</code> with <code>using Microsoft.VisualStudio.TestTools.UnitTesting;</code> (I actually use a project level import, so I skip this)</li><li>[TestFixture] -> [TestClass]</li><li>[Test] -> [TestMethod]</li><li>[SetUp] -> [TestInitialize]</li><li>[TearDown] -> [TestCleanup]</li><li>[TestFixtureSetUp] -> [ClassInitialize]</li><li>[TestFixtureTearDown] -> [ClassCleanup]</li></ul><ol start=4><li>Change your Asserts:</li></ol><ul><li>Assert.Greater(x, y) -> Assert.IsTrue(x > y)</li><li>Assert.AreEqual(x, Is.EqualTo(y).IgnoreCase) -> Assert.AreEqual(x, y, True)</li></ul><ol start=5><li>The &lsquo;hidden&rsquo; part. In your project file, locate <code>&lt;PropertyGroup></code> (not the one specifying debug|release settings), and add the following to it:</li></ol><ul><li>512</li><li>*.csproj files add:
<code>&lt;ProjectTypeGuids>{3AC096D0-A1C2-E12C-1390-A8335801FDAB};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}&lt;/ProjectTypeGuids></code></li><li>*.vbproj files add:
<code>&lt;ProjectTypeGuids>{3AC096D0-A1C2-E12C-1390-A8335801FDAB};{F184B08F-C81C-45F6-A57F-5ABD9991F28F}&lt;/ProjectTypeGuids></code></li></ul><p>This was all I had to do to get our (my) tests running again under MSTest. Except they didn&rsquo;t run, with the lovely error of:</p><blockquote><p>The location of the file or directory &lsquo;D:\Projects\Dev\SDK\Rhino.Mocks.dll&rsquo; is not trusted.</p></blockquote><p>That&rsquo;s odd, the file is on my hard disk, its not a network share, so what&rsquo;s the problem? Right click on Rhino.Mocks.dll and:</p><p><img loading=lazy src=/images/unblock-file.jpg alt="Unblock File"></p><p>Click the Unblock button, hit Apply, re-run the tests. All Working now :)</p><p>There are a few other points mentioned on the MSDN post too which you may run into:</p><blockquote><p>If you have relied on NUnit TestFixtureSetup and TestFixtureTearDown methods to do non-static things, will have to move functions in the former to a constructor and the latter to a destructor. In MSTest, both of these methods must be declared as static.</p></blockquote><blockquote><p>If you are relying on AppDomain.CurrentDomain.BaseDirectory to get the root directory, your test will break. The fix is explained at <a href=http://www.ademiller.com/blogs/tech/2008/01/gotchas-mstest-appdomain-changes-in-vs-2008/>http://www.ademiller.com/blogs/tech/2008/01/gotchas-mstest-appdomain-changes-in-vs-2008/</a>.</p></blockquote><p>Basically, you need to set your BaseDirectory in your MSTest TestClass constructor like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>string</span> currDir = Environment.CurrentDirectory.Substring(<span style=color:#ae81ff>0</span>, Environment.CurrentDirectory.IndexOf(<span style=color:#e6db74>&#34;TestResults&#34;</span>));
</span></span><span style=display:flex><span>AppDomain.CurrentDomain.SetData(<span style=color:#e6db74>&#34;APPBASE&#34;</span>, currDir);
</span></span></code></pre></div><blockquote><p>MSTest launches each test method in a separate STA thread instead of the MTA thread you may be expecting. This probably won&rsquo;t give you any problems.</p></blockquote><p>Hope that helps everyone who has to do this kind of conversion.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://andydote.co.uk/tags/c#/>c#</a></li></ul><nav class=paginav><a class=prev href=https://andydote.co.uk/2010/03/24/multilining-if-statements-conditions-should-be-banned-now/><span class=title>« Prev Page</span><br><span>Multilining If statements conditions should be banned. now.</span></a>
<a class=next href=https://andydote.co.uk/2009/12/16/thanks-google-for-solving-my-problem/><span class=title>Next Page »</span><br><span>Thanks Google for solving my problem!</span></a></nav></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
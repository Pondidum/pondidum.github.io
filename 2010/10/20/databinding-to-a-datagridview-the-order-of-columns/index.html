<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Databinding to a DataGridView - The order of columns | Andy Dote</title><meta name=keywords content="controls,bug,c#"><meta name=description content="A while ago I was writing a small history grid in one of our applications at work. It has a single HistoryItem object, which is fairly straightforward, something like this:
Class HistoryItem { 	public int ID { get{ return _id; } } 	public DateTime CreateDate { get { return _createDate; } } 	public String Creator { get { return _creatorName; } } 	public String Note { get { return _note; } } } This was populated into a List<HistoryItem> and bound to the DataGridView directly:"><meta name=author content><link rel=canonical href=https://andydote.co.uk/2010/10/20/databinding-to-a-datagridview-the-order-of-columns/><link crossorigin=anonymous href=/assets/css/stylesheet.min.b4e19c453811e60acfec1f00c15ac2be1c53f6ab90187e684358ce7faaf48bab.css integrity="sha256-tOGcRTgR5grP7B8AwVrCvhxT9quQGH5oQ1jOf6r0i6s=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://andydote.co.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://andydote.co.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://andydote.co.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://andydote.co.uk/apple-touch-icon.png><link rel=mask-icon href=https://andydote.co.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Databinding to a DataGridView - The order of columns"><meta property="og:description" content="A while ago I was writing a small history grid in one of our applications at work. It has a single HistoryItem object, which is fairly straightforward, something like this:
Class HistoryItem { 	public int ID { get{ return _id; } } 	public DateTime CreateDate { get { return _createDate; } } 	public String Creator { get { return _creatorName; } } 	public String Note { get { return _note; } } } This was populated into a List<HistoryItem> and bound to the DataGridView directly:"><meta property="og:type" content="article"><meta property="og:url" content="https://andydote.co.uk/2010/10/20/databinding-to-a-datagridview-the-order-of-columns/"><meta property="article:section" content="post"><meta property="article:published_time" content="2010-10-20T00:00:00+00:00"><meta property="article:modified_time" content="2010-10-20T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Databinding to a DataGridView - The order of columns"><meta name=twitter:description content="A while ago I was writing a small history grid in one of our applications at work. It has a single HistoryItem object, which is fairly straightforward, something like this:
Class HistoryItem { 	public int ID { get{ return _id; } } 	public DateTime CreateDate { get { return _createDate; } } 	public String Creator { get { return _creatorName; } } 	public String Note { get { return _note; } } } This was populated into a List<HistoryItem> and bound to the DataGridView directly:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://andydote.co.uk/post/"},{"@type":"ListItem","position":3,"name":"Databinding to a DataGridView - The order of columns","item":"https://andydote.co.uk/2010/10/20/databinding-to-a-datagridview-the-order-of-columns/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Databinding to a DataGridView - The order of columns","name":"Databinding to a DataGridView - The order of columns","description":"A while ago I was writing a small history grid in one of our applications at work. It has a single HistoryItem object, which is fairly straightforward, something like this:\nClass HistoryItem { \tpublic int ID { get{ return _id; } } \tpublic DateTime CreateDate { get { return _createDate; } } \tpublic String Creator { get { return _creatorName; } } \tpublic String Note { get { return _note; } } } This was populated into a List\u0026lt;HistoryItem\u0026gt; and bound to the DataGridView directly:","keywords":["controls","bug","c#"],"articleBody":"A while ago I was writing a small history grid in one of our applications at work. It has a single HistoryItem object, which is fairly straightforward, something like this:\nClass HistoryItem { \tpublic int ID { get{ return _id; } } \tpublic DateTime CreateDate { get { return _createDate; } } \tpublic String Creator { get { return _creatorName; } } \tpublic String Note { get { return _note; } } } This was populated into a List and bound to the DataGridView directly:\n\tdgvHistory.DataSource = ScreenEntity.History.ToList(); This exposes something interesting about how the DataGridView picks column order: It’s not done by Alphabetical Order; it is done by Definition Order. So the order in which the properties in the class are defined is the order that the grid view will display. Usually.\nWhen the piece of software was deployed (in house software, to be used by about 10 people), one user requested the order of the columns be changed. She didn’t like the fact that the order was this for her: Note, ID, CreateDate, Creator.\nAfter checking my copy of the software and several other users’ copies, it turned out the order was only different on her machine. She could login to another machine and it would be fine. At the time I never got to the bottom of why it was setting the wrong order, but fixed it by manually specifying the column order after binding.\nYesterday however I was reading an article by Abhishek Sur on the Hidden Facts of C# Structures in terms of MSIL and noticed this piece of information:\n DemoClass is declared as auto…Auto allows the loader to change the layout of the class which it sees fit. That means the order of the members will not be kept intact while the object is created. It is also going to ignore any layout information for the class mentioned explicitly.\n Now while I am unable to reproduce this problem currently as I am not near work, I do wonder if the reason column orders were fine on most machines was because the CLR was keeping the properties in definition order, with the exception of one machine, where for whatever reason it was reordering the properties.\nIf this problem arises again then I will have a go at fixing it by changing to a Structure (which by default are declared as Sequential in IL) and see if that fixes the problem.\n","wordCount":"405","inLanguage":"en","datePublished":"2010-10-20T00:00:00Z","dateModified":"2010-10-20T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://andydote.co.uk/2010/10/20/databinding-to-a-datagridview-the-order-of-columns/"},"publisher":{"@type":"Organization","name":"Andy Dote","logo":{"@type":"ImageObject","url":"https://andydote.co.uk/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://andydote.co.uk accesskey=h title="Andy Dote (Alt + H)">Andy Dote</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://andydote.co.uk/archive title=Archive><span>Archive</span></a></li><li><a href=https://andydote.co.uk/talks title=Talks><span>Talks</span></a></li><li><a href=https://andydote.co.uk/notes title=Notes><span>Notes</span></a></li><li><a href=https://andydote.co.uk/tags title=Tags><span>Tags</span></a></li><li><a href=https://andydote.co.uk/contact title=Contact><span>Contact</span></a></li><li><a href=https://andydote.co.uk/rss.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Databinding to a DataGridView - The order of columns</h1><div class=post-meta><span title="2010-10-20 00:00:00 +0000 UTC">October 20, 2010</span>&nbsp;·&nbsp;2 min</div></header><div class=post-content><p>A while ago I was writing a small history grid in one of our applications at work. It has a single <code>HistoryItem</code> object, which is fairly straightforward, something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>Class HistoryItem
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>int</span> ID { <span style=color:#66d9ef>get</span>{ <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>_</span>id; } }
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> DateTime CreateDate { <span style=color:#66d9ef>get</span> { <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>_</span>createDate; } }
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> String Creator { <span style=color:#66d9ef>get</span> { <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>_</span>creatorName; } }
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> String Note { <span style=color:#66d9ef>get</span> { <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>_</span>note; } }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This was populated into a <code>List&lt;HistoryItem></code> and bound to the <code>DataGridView</code> directly:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>	dgvHistory.DataSource = ScreenEntity.History.ToList();
</span></span></code></pre></div><p>This exposes something interesting about how the DataGridView picks column order: It&rsquo;s not done by Alphabetical Order; it is done by Definition Order. So the order in which the properties in the class are defined is the order that the grid view will display. Usually.</p><p>When the piece of software was deployed (in house software, to be used by about 10 people), one user requested the order of the columns be changed. She didn&rsquo;t like the fact that the order was this for her: <code>Note, ID, CreateDate, Creator</code>.</p><p>After checking my copy of the software and several other users&rsquo; copies, it turned out the order was only different on her machine. She could login to another machine and it would be fine. At the time I never got to the bottom of why it was setting the wrong order, but fixed it by manually specifying the column order after binding.</p><p>Yesterday however I was reading an article by <a href=http://www.abhisheksur.com/2010/10/hidden-facts-on-c-constructor-in.html>Abhishek Sur on the Hidden Facts of C# Structures in terms of MSIL</a> and noticed this piece of information:</p><blockquote><p>DemoClass is declared as auto&mldr;Auto allows the loader to change the layout of the class which it sees fit. That means the order of the members will not be kept intact while the object is created. It is also going to ignore any layout information for the class mentioned explicitly.</p></blockquote><p>Now while I am unable to reproduce this problem currently as I am not near work, I do wonder if the reason column orders were fine on most machines was because the CLR was keeping the properties in definition order, with the exception of one machine, where for whatever reason it was reordering the properties.</p><p>If this problem arises again then I will have a go at fixing it by changing to a Structure (which by default are declared as Sequential in IL) and see if that fixes the problem.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://andydote.co.uk/tags/controls/>controls</a></li><li><a href=https://andydote.co.uk/tags/bug/>bug</a></li><li><a href=https://andydote.co.uk/tags/c#/>c#</a></li></ul><nav class=paginav><a class=prev href=https://andydote.co.uk/2010/11/13/adding-mspec-to-your-git-bash/><span class=title>« Prev Page</span><br><span>Adding MSpec to your Git Bash</span></a>
<a class=next href=https://andydote.co.uk/2010/09/10/actually-i-ll-mutate-if-you-don-t-mind/><span class=title>Next Page »</span><br><span>Actually, I'll mutate if you don't mind</span></a></nav></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>
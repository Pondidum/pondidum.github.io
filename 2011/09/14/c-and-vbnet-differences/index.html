<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>C# and Vb.Net Differences | Andy Dote</title><meta name=keywords content="c#"><meta name=description content="So I have been doing some work that involves C# and VB libraries and apps using each other, and have noticed a lot of subtle differences between the two languages.
Declaration of types inside an interface: Public Interface ITesting ReadOnly Property Test() As TestData Class TestData Public Sub New() StringProperty = &#34;testing&#34; IntProperty = 1234 End Sub Public Property StringProperty() As String Public Property IntProperty() As Integer End Class End Interface However in C#, you cannot declare types inside an interface, however it is quite happy to consume one create in a VB project:"><meta name=author content><link rel=canonical href=https://andydote.co.uk/2011/09/14/c-and-vbnet-differences/><link crossorigin=anonymous href=/assets/css/stylesheet.min.b4e19c453811e60acfec1f00c15ac2be1c53f6ab90187e684358ce7faaf48bab.css integrity="sha256-tOGcRTgR5grP7B8AwVrCvhxT9quQGH5oQ1jOf6r0i6s=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.e85ad0406048e8176e1c7661b25d5c69297ddfe41dc4124cf75ecb99a4f7b3d1.js integrity="sha256-6FrQQGBI6BduHHZhsl1caSl93+QdxBJM917LmaT3s9E=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://andydote.co.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://andydote.co.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://andydote.co.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://andydote.co.uk/apple-touch-icon.png><link rel=mask-icon href=https://andydote.co.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="C# and Vb.Net Differences"><meta property="og:description" content="So I have been doing some work that involves C# and VB libraries and apps using each other, and have noticed a lot of subtle differences between the two languages.
Declaration of types inside an interface: Public Interface ITesting ReadOnly Property Test() As TestData Class TestData Public Sub New() StringProperty = &#34;testing&#34; IntProperty = 1234 End Sub Public Property StringProperty() As String Public Property IntProperty() As Integer End Class End Interface However in C#, you cannot declare types inside an interface, however it is quite happy to consume one create in a VB project:"><meta property="og:type" content="article"><meta property="og:url" content="https://andydote.co.uk/2011/09/14/c-and-vbnet-differences/"><meta property="article:section" content="post"><meta property="article:published_time" content="2011-09-14T00:00:00+00:00"><meta property="article:modified_time" content="2011-09-14T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="C# and Vb.Net Differences"><meta name=twitter:description content="So I have been doing some work that involves C# and VB libraries and apps using each other, and have noticed a lot of subtle differences between the two languages.
Declaration of types inside an interface: Public Interface ITesting ReadOnly Property Test() As TestData Class TestData Public Sub New() StringProperty = &#34;testing&#34; IntProperty = 1234 End Sub Public Property StringProperty() As String Public Property IntProperty() As Integer End Class End Interface However in C#, you cannot declare types inside an interface, however it is quite happy to consume one create in a VB project:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://andydote.co.uk/post/"},{"@type":"ListItem","position":3,"name":"C# and Vb.Net Differences","item":"https://andydote.co.uk/2011/09/14/c-and-vbnet-differences/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"C# and Vb.Net Differences","name":"C# and Vb.Net Differences","description":"So I have been doing some work that involves C# and VB libraries and apps using each other, and have noticed a lot of subtle differences between the two languages.\nDeclaration of types inside an interface: Public Interface ITesting ReadOnly Property Test() As TestData Class TestData Public Sub New() StringProperty = \u0026#34;testing\u0026#34; IntProperty = 1234 End Sub Public Property StringProperty() As String Public Property IntProperty() As Integer End Class End Interface However in C#, you cannot declare types inside an interface, however it is quite happy to consume one create in a VB project:","keywords":["c#"],"articleBody":"So I have been doing some work that involves C# and VB libraries and apps using each other, and have noticed a lot of subtle differences between the two languages.\nDeclaration of types inside an interface: Public Interface ITesting ReadOnly Property Test() As TestData Class TestData Public Sub New() StringProperty = \"testing\" IntProperty = 1234 End Sub Public Property StringProperty() As String Public Property IntProperty() As Integer End Class End Interface However in C#, you cannot declare types inside an interface, however it is quite happy to consume one create in a VB project:\nvar test = new VbLib.ITesting.TestData(); That is not to say it is a good thing to do - I have encountered problems with XML Deserialization not working if it needed to deserialize an enum that was declared inside an interface.\nIndexed Properties Again, this is perfectly legal in VB:\nPublic Class CustomCollection Inherits List(Of CustomObject) Default Public Shadows ReadOnly Property Item(ByVal index As Integer) As CustomObject Get Return MyBase.Item(index) End Get End Property Public ReadOnly Property IndexedReadOnly(ByVal index As Integer) As CustomObject Get Return Me(index) End Get End Property Public Property IndexedReadWrite(ByVal index As Integer) As CustomObject Get Return Me(index) End Get Set(ByVal value As CustomObject) MyBase.Item(index) = value End Set End Property Public ReadOnly Property EnumIndexed(ByVal type As CustomObject.CustomTypes) As CustomObject Get Return Me.FirstOrDefault(Function(x) x.Type = type) End Get End Property End Class It compiles, and runs fine from VB:\nPublic Sub Test() Dim collection = New CustomCollection() Dim output = collection.EnumIndexed(CustomObject.CustomTypes.Testing) End Sub However trying to consume this from C# will not work:\nvar item = collection.EnumIndexed(VbLib.CustomObject.CustomTypes.Other); But like this will:\nvar item = collection.get_EnumIndexed(VbLib.CustomObject.CustomTypes.Other); ","wordCount":"271","inLanguage":"en","datePublished":"2011-09-14T00:00:00Z","dateModified":"2011-09-14T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://andydote.co.uk/2011/09/14/c-and-vbnet-differences/"},"publisher":{"@type":"Organization","name":"Andy Dote","logo":{"@type":"ImageObject","url":"https://andydote.co.uk/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://andydote.co.uk accesskey=h title="Andy Dote (Alt + H)">Andy Dote</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://andydote.co.uk/archive title=Archive><span>Archive</span></a></li><li><a href=https://andydote.co.uk/talks title=Talks><span>Talks</span></a></li><li><a href=https://andydote.co.uk/notes title=Notes><span>Notes</span></a></li><li><a href=https://andydote.co.uk/tags title=Tags><span>Tags</span></a></li><li><a href=https://andydote.co.uk/contact title=Contact><span>Contact</span></a></li><li><a href=https://andydote.co.uk/rss.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>C# and Vb.Net Differences</h1><div class=post-meta><span title='2011-09-14 00:00:00 +0000 UTC'>September 14, 2011</span>&nbsp;Â·&nbsp;2 min</div></header><div class=post-content><p>So I have been doing some work that involves C# and VB libraries and apps using each other, and have noticed a lot of subtle differences between the two languages.</p><h2 id=declaration-of-types-inside-an-interface>Declaration of types inside an interface:<a hidden class=anchor aria-hidden=true href=#declaration-of-types-inside-an-interface>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb data-lang=vb><span style=display:flex><span><span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Interface</span> ITesting
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>ReadOnly</span> <span style=color:#66d9ef>Property</span> <span style=color:#a6e22e>Test</span>() <span style=color:#f92672>As</span> TestData
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Class</span> <span style=color:#a6e22e>TestData</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>New</span>()
</span></span><span style=display:flex><span>			StringProperty <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;testing&#34;</span>
</span></span><span style=display:flex><span>			IntProperty <span style=color:#f92672>=</span> 1234
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Sub</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Property</span> <span style=color:#a6e22e>StringProperty</span>() <span style=color:#f92672>As</span> <span style=color:#66d9ef>String</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Property</span> <span style=color:#a6e22e>IntProperty</span>() <span style=color:#f92672>As</span> <span style=color:#66d9ef>Integer</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Class</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Interface</span>
</span></span></code></pre></div><p>However in C#, you cannot declare types inside an interface, however it is quite happy to consume one create in a VB project:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>var</span> test = <span style=color:#66d9ef>new</span> VbLib.ITesting.TestData();
</span></span></code></pre></div><p>That is not to say it is a good thing to do - I have encountered problems with XML Deserialization not working if it needed to deserialize an enum that was declared inside an interface.</p><h2 id=indexed-properties>Indexed Properties<a hidden class=anchor aria-hidden=true href=#indexed-properties>#</a></h2><p>Again, this is perfectly legal in VB:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb data-lang=vb><span style=display:flex><span><span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Class</span> <span style=color:#a6e22e>CustomCollection</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Inherits</span> List(<span style=color:#66d9ef>Of</span> CustomObject)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Default</span> <span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Shadows</span> <span style=color:#66d9ef>ReadOnly</span> <span style=color:#66d9ef>Property</span> <span style=color:#a6e22e>Item</span>(<span style=color:#66d9ef>ByVal</span> index <span style=color:#f92672>As</span> <span style=color:#66d9ef>Integer</span>) <span style=color:#f92672>As</span> CustomObject
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>Get</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>Return</span> <span style=color:#66d9ef>MyBase</span>.Item(index)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Get</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Property</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>ReadOnly</span> <span style=color:#66d9ef>Property</span> <span style=color:#a6e22e>IndexedReadOnly</span>(<span style=color:#66d9ef>ByVal</span> index <span style=color:#f92672>As</span> <span style=color:#66d9ef>Integer</span>) <span style=color:#f92672>As</span> CustomObject
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>Get</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>Return</span> <span style=color:#66d9ef>Me</span>(index)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Get</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Property</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Property</span> <span style=color:#a6e22e>IndexedReadWrite</span>(<span style=color:#66d9ef>ByVal</span> index <span style=color:#f92672>As</span> <span style=color:#66d9ef>Integer</span>) <span style=color:#f92672>As</span> CustomObject
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>Get</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>Return</span> <span style=color:#66d9ef>Me</span>(index)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Get</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>Set</span>(<span style=color:#66d9ef>ByVal</span> value <span style=color:#f92672>As</span> CustomObject)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>MyBase</span>.Item(index) <span style=color:#f92672>=</span> value
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Set</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Property</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>ReadOnly</span> <span style=color:#66d9ef>Property</span> <span style=color:#a6e22e>EnumIndexed</span>(<span style=color:#66d9ef>ByVal</span> type <span style=color:#f92672>As</span> CustomObject.CustomTypes) <span style=color:#f92672>As</span> CustomObject
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>Get</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>Return</span> <span style=color:#66d9ef>Me</span>.FirstOrDefault(Function(x) x.Type <span style=color:#f92672>=</span> type)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Get</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Property</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Class</span>
</span></span></code></pre></div><p>It compiles, and runs fine from VB:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb data-lang=vb><span style=display:flex><span><span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>Test</span>()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Dim</span> collection <span style=color:#f92672>=</span> <span style=color:#66d9ef>New</span> CustomCollection()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Dim</span> output <span style=color:#f92672>=</span> collection.EnumIndexed(CustomObject.CustomTypes.Testing)
</span></span><span style=display:flex><span><span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Sub</span>
</span></span></code></pre></div><p>However trying to consume this from C# will not work:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>var</span> item = collection.EnumIndexed(VbLib.CustomObject.CustomTypes.Other);
</span></span></code></pre></div><p>But like this will:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>var</span> item = collection.get_EnumIndexed(VbLib.CustomObject.CustomTypes.Other);
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://andydote.co.uk/tags/c#/>c#</a></li></ul><nav class=paginav><a class=prev href=https://andydote.co.uk/2011/10/22/noticing-changes/><span class=title>Â« Prev Page</span><br><span>Noticing Changes</span></a>
<a class=next href=https://andydote.co.uk/2011/08/09/c-enum-casting/><span class=title>Next Page Â»</span><br><span>c# Enum casting</span></a></nav></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
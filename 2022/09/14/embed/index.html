<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Embedding ain't easy, but its alright | Andy Dote</title><meta name=keywords content="hugo,writing"><meta name=description content="I write a lot of blog posts which contain code snippets. Like most people, I have done this using a fenced codeblock in markdown which is fine for short blocks of code.
The problem occours when I am embedding code from another repository; often there will be tweaks or bug fixes, and keeping the code in the blog post in sync with the code in the other repo is annoying and manual."><meta name=author content><link rel=canonical href=https://andydote.co.uk/2022/09/14/embed/><link crossorigin=anonymous href=/assets/css/stylesheet.min.d3aaf8cdcec9a6487824ab95cadf08232ec362e7ba510c6b742973d16ef5b72e.css integrity="sha256-06r4zc7Jpkh4JKuVyt8IIy7DYue6UQxrdClz0W71ty4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/mermaid.min.725f44bd345b0a2a4043ca952b0863edd789e913cf0813a12bbdfe986fe87079.js integrity="sha256-cl9EvTRbCipAQ8qVKwhj7deJ6RPPCBOhK73+mG/ocHk="></script>
<script defer crossorigin=anonymous src=/js/tabs.min.2d019e9ee3574770ad4ecfd4f5f794739892195cb82a4e6383252b9074ab520c.js integrity="sha256-LQGenuNXR3CtTs/U9feUc5iSGVy4Kk5jgyUrkHSrUgw="></script>
<link rel=icon href=https://andydote.co.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://andydote.co.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://andydote.co.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://andydote.co.uk/apple-touch-icon.png><link rel=mask-icon href=https://andydote.co.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Embedding ain't easy, but its alright"><meta property="og:description" content="I write a lot of blog posts which contain code snippets. Like most people, I have done this using a fenced codeblock in markdown which is fine for short blocks of code.
The problem occours when I am embedding code from another repository; often there will be tweaks or bug fixes, and keeping the code in the blog post in sync with the code in the other repo is annoying and manual."><meta property="og:type" content="article"><meta property="og:url" content="https://andydote.co.uk/2022/09/14/embed/"><meta property="article:section" content="post"><meta name=twitter:card content="summary"><meta name=twitter:title content="Embedding ain't easy, but its alright"><meta name=twitter:description content="I write a lot of blog posts which contain code snippets. Like most people, I have done this using a fenced codeblock in markdown which is fine for short blocks of code.
The problem occours when I am embedding code from another repository; often there will be tweaks or bug fixes, and keeping the code in the blog post in sync with the code in the other repo is annoying and manual."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://andydote.co.uk/post/"},{"@type":"ListItem","position":3,"name":"Embedding ain't easy, but its alright","item":"https://andydote.co.uk/2022/09/14/embed/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Embedding ain't easy, but its alright","name":"Embedding ain\u0027t easy, but its alright","description":"I write a lot of blog posts which contain code snippets. Like most people, I have done this using a fenced codeblock in markdown which is fine for short blocks of code.\nThe problem occours when I am embedding code from another repository; often there will be tweaks or bug fixes, and keeping the code in the blog post in sync with the code in the other repo is annoying and manual.","keywords":["hugo","writing"],"articleBody":"I write a lot of blog posts which contain code snippets. Like most people, I have done this using a fenced codeblock in markdown which is fine for short blocks of code.\nThe problem occours when I am embedding code from another repository; often there will be tweaks or bug fixes, and keeping the code in the blog post in sync with the code in the other repo is annoying and manual.\nTo make life easier for myself, I wrote a shortcode called git-embed, which at build time will fetch the specified file, and embed either the whole file, or a line range in a highlighted code block. It supports line ranges (start, finish), and it will use the file’s extension as the highlight language, unless you override with lang parameter.\nUsage is like this:\n{{\u003c git-embed user=\"Pondidum\" repo=\"pondidum.github.io\" ref=\"master\" file=\"layouts/shortcodes/git-embed.html\" lang=\"go\" \u003e}} Which I am using to embed the shorcode’s own shortcode:\n{{- $user := .Get \"user\" -}} {{- $repo := .Get \"repo\" -}} {{- $ref := .Get \"ref\" -}} {{- $file := .Get \"file\" -}} {{- $source := printf \"https://github.com/%s/%s/blob/%s/%s\" $user $repo $ref $file -}} {{- $url := printf \"https://raw.githubusercontent.com/%s/%s/%s/%s\" $user $repo $ref $file -}} {{- $remote := resources.GetRemote $url -}} {{ $all_lines := split $remote.Content \"\\n\" -}} {{- $start := 1 -}} {{- if isset .Params \"start\" -}} {{- $start = (.Get \"start\") | int -}} {{- end -}} {{- $finish := len $all_lines -}} {{- if isset .Params \"finish\" -}} {{ $finish = (.Get \"finish\") | int -}} {{- end -}} {{- $start = math.Max $start 1 -}} {{- $finish = math.Min $finish (len $all_lines) -}} {{- $lines := slice -}} {{- range $index, $num := (seq (add $start -1) (add $finish -1)) -}} {{- $lines = $lines | append (index $all_lines $num) -}} {{- end -}} {{- $lang := strings.TrimPrefix \".\" (path.Ext $file) -}} {{- if isset .Params \"lang\" -}} {{- $lang = .Get \"lang\" -}} {{- end -}} {{- $options := \"\" -}} {{- if isset .Params \"options\" -}} {{- $options = .Get \"options\" -}} {{- end -}} {{- highlight ( delimit $lines \"\\n\") $lang $options -}} \u003cfooter style=\"margin: 10px auto;\"\u003e \u003csmall\u003e\u003ca href=\"{{- $source -}}\"\u003eSource\u003c/a\u003e\u003c/small\u003e \u003c/footer\u003e Source Future Improvements I’d quite like to add a parameter that would allow me to embed a named function, rather than a line range. I think I’d use Tree-Sitter to do this, but Hugo doesn’t seem to have a way to execute an arbitrary command on build, so I’d need to make a small API that would do all the work… So that can wait for when the itch needs scratching more than this.\n","wordCount":"436","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://andydote.co.uk/2022/09/14/embed/"},"publisher":{"@type":"Organization","name":"Andy Dote","logo":{"@type":"ImageObject","url":"https://andydote.co.uk/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://andydote.co.uk accesskey=h title="Andy Dote (Alt + H)">Andy Dote</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://andydote.co.uk/archive title=Archive><span>Archive</span></a></li><li><a href=https://andydote.co.uk/talks title=Talks><span>Talks</span></a></li><li><a href=https://andydote.co.uk/notes title=Notes><span>Notes</span></a></li><li><a href=https://andydote.co.uk/tags title=Tags><span>Tags</span></a></li><li><a href=https://andydote.co.uk/contact title=Contact><span>Contact</span></a></li><li><a href=https://andydote.co.uk/rss.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Embedding ain't easy, but its alright</h1><div class=post-meta><span title='2022-09-14 00:00:00 +0000 UTC'>September 14, 2022</span>&nbsp;·&nbsp;3 min</div></header><div class=post-content><p>I write a lot of blog posts which contain code snippets. Like most people, I have done this using a fenced codeblock in markdown which is fine for short blocks of code.</p><p>The problem occours when I am embedding code from another repository; often there will be tweaks or bug fixes, and keeping the code in the blog post in sync with the code in the other repo is annoying and manual.</p><p>To make life easier for myself, I wrote a <a href=https://gohugo.io/content-management/shortcodes/>shortcode</a> called <code>git-embed</code>, which at build time will fetch the specified file, and embed either the whole file, or a line range in a highlighted code block. It supports line ranges (<code>start</code>, <code>finish</code>), and it will use the <code>file</code>&rsquo;s extension as the highlight language, unless you override with <code>lang</code> parameter.</p><p>Usage is like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-markdown data-lang=markdown><span style=display:flex><span>{{&lt; <span style=color:#f92672>git-embed</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>user</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Pondidum&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>repo</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pondidum.github.io&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ref</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;master&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>file</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;layouts/shortcodes/git-embed.html&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;go&#34;</span>
</span></span><span style=display:flex><span>&gt;}}
</span></span></code></pre></div><p>Which I am using to embed the shorcode&rsquo;s own shortcode:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>user</span> <span style=color:#f92672>:=</span> .<span style=color:#a6e22e>Get</span> <span style=color:#e6db74>&#34;user&#34;</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>repo</span> <span style=color:#f92672>:=</span> .<span style=color:#a6e22e>Get</span> <span style=color:#e6db74>&#34;repo&#34;</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>ref</span> <span style=color:#f92672>:=</span> .<span style=color:#a6e22e>Get</span> <span style=color:#e6db74>&#34;ref&#34;</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>file</span> <span style=color:#f92672>:=</span> .<span style=color:#a6e22e>Get</span> <span style=color:#e6db74>&#34;file&#34;</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>source</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>printf</span> <span style=color:#e6db74>&#34;https://github.com/%s/%s/blob/%s/%s&#34;</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>user</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>repo</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>ref</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>file</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>url</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>printf</span> <span style=color:#e6db74>&#34;https://raw.githubusercontent.com/%s/%s/%s/%s&#34;</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>user</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>repo</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>ref</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>file</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>remote</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>resources</span>.<span style=color:#a6e22e>GetRemote</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>url</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{{ <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>all_lines</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>split</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>remote</span>.<span style=color:#a6e22e>Content</span> <span style=color:#e6db74>&#34;\n&#34;</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>start</span> <span style=color:#f92672>:=</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>isset</span> .<span style=color:#a6e22e>Params</span> <span style=color:#e6db74>&#34;start&#34;</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>  {{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>start</span> = (.<span style=color:#a6e22e>Get</span> <span style=color:#e6db74>&#34;start&#34;</span>) | <span style=color:#66d9ef>int</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#a6e22e>end</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>finish</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>len</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>all_lines</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>isset</span> .<span style=color:#a6e22e>Params</span> <span style=color:#e6db74>&#34;finish&#34;</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>  {{ <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>finish</span> = (.<span style=color:#a6e22e>Get</span> <span style=color:#e6db74>&#34;finish&#34;</span>) | <span style=color:#66d9ef>int</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#a6e22e>end</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>start</span> = <span style=color:#a6e22e>math</span>.<span style=color:#a6e22e>Max</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>start</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>finish</span> = <span style=color:#a6e22e>math</span>.<span style=color:#a6e22e>Min</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>finish</span> (<span style=color:#a6e22e>len</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>all_lines</span>) <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>lines</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>slice</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#66d9ef>range</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>index</span>, <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>num</span> <span style=color:#f92672>:=</span> (<span style=color:#a6e22e>seq</span> (<span style=color:#a6e22e>add</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>start</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) (<span style=color:#a6e22e>add</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>finish</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)) <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>  {{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>lines</span> = <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>lines</span> | <span style=color:#a6e22e>append</span> (<span style=color:#a6e22e>index</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>all_lines</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>num</span>) <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#a6e22e>end</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>lang</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>TrimPrefix</span> <span style=color:#e6db74>&#34;.&#34;</span> (<span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>Ext</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>file</span>) <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>isset</span> .<span style=color:#a6e22e>Params</span> <span style=color:#e6db74>&#34;lang&#34;</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>  {{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>lang</span> = .<span style=color:#a6e22e>Get</span> <span style=color:#e6db74>&#34;lang&#34;</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#a6e22e>end</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>options</span> <span style=color:#f92672>:=</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>isset</span> .<span style=color:#a6e22e>Params</span> <span style=color:#e6db74>&#34;options&#34;</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>  {{<span style=color:#f92672>-</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>options</span> = .<span style=color:#a6e22e>Get</span> <span style=color:#e6db74>&#34;options&#34;</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#a6e22e>end</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{{<span style=color:#f92672>-</span> <span style=color:#a6e22e>highlight</span> ( <span style=color:#a6e22e>delimit</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>lines</span> <span style=color:#e6db74>&#34;\n&#34;</span>) <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>lang</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#a6e22e>options</span> <span style=color:#f92672>-</span>}}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#a6e22e>footer</span> <span style=color:#a6e22e>style</span>=<span style=color:#e6db74>&#34;margin: 10px auto;&#34;</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#a6e22e>small</span>&gt;&lt;<span style=color:#a6e22e>a</span> <span style=color:#a6e22e>href</span>=<span style=color:#e6db74>&#34;{{- $source -}}&#34;</span>&gt;<span style=color:#a6e22e>Source</span>&lt;<span style=color:#f92672>/</span><span style=color:#a6e22e>a</span>&gt;&lt;<span style=color:#f92672>/</span><span style=color:#a6e22e>small</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>/</span><span style=color:#a6e22e>footer</span>&gt;
</span></span></code></pre></div><footer style="margin:10px auto"><small><a href=https://github.com/Pondidum/pondidum.github.io/blob/master/layouts/shortcodes/git-embed.html>Source</a></small></footer><h2 id=future-improvements>Future Improvements<a hidden class=anchor aria-hidden=true href=#future-improvements>#</a></h2><p>I&rsquo;d quite like to add a parameter that would allow me to embed a named function, rather than a line range. I think I&rsquo;d use <a href=https://tree-sitter.github.io/tree-sitter/>Tree-Sitter</a> to do this, but Hugo doesn&rsquo;t seem to have a way to execute an arbitrary command on build, so I&rsquo;d need to make a small API that would do all the work&mldr; So that can wait for when the itch needs scratching more than this.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://andydote.co.uk/tags/hugo/>hugo</a></li><li><a href=https://andydote.co.uk/tags/writing/>writing</a></li></ul><nav class=paginav><a class=prev href=https://andydote.co.uk/2022/09/19/make-content-hash/><span class=title>« Prev Page</span><br><span>Content based change detection with Make</span></a>
<a class=next href=https://andydote.co.uk/2022/09/11/uml-isnt-dead/><span class=title>Next Page »</span><br><span>The reports of UML's death are greatly exaggerated</span></a></nav></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>VB.NET &amp;amp; C# Fixed height User Controls | Andy Dote</title>
<meta name=keywords content="design,controls,c#"><meta name=description content="Another problem I came across recently was fixed height user controls. Someone at work had created a fixed height user control, by putting the following code in the paint event:
Me.Width = 20 Now while for the majority of cases this works, it doesn&rsquo;t if you dock the control to the left or right of the form, as each time the Layout Engine tries to stick the top of the control to the top of the parent and the bottom of the control to the bottom of the parent, it fires the Paint() event."><meta name=author content><link rel=canonical href=https://andydote.co.uk/2008/03/29/vbnet-c-fixed-height-user-controls/><link crossorigin=anonymous href=/assets/css/stylesheet.min.d3aaf8cdcec9a6487824ab95cadf08232ec362e7ba510c6b742973d16ef5b72e.css integrity="sha256-06r4zc7Jpkh4JKuVyt8IIy7DYue6UQxrdClz0W71ty4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/mermaid.min.c6a36963ab47314b3d95fe85a9385337e1ef8eb1c2194eecb86f178d492ab666.js integrity="sha256-xqNpY6tHMUs9lf6FqThTN+HvjrHCGU7suG8XjUkqtmY="></script><script defer crossorigin=anonymous src=/js/tabs.min.2d019e9ee3574770ad4ecfd4f5f794739892195cb82a4e6383252b9074ab520c.js integrity="sha256-LQGenuNXR3CtTs/U9feUc5iSGVy4Kk5jgyUrkHSrUgw="></script><link rel=icon href=https://andydote.co.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://andydote.co.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://andydote.co.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://andydote.co.uk/apple-touch-icon.png><link rel=mask-icon href=https://andydote.co.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="VB.NET &amp;amp; C# Fixed height User Controls"><meta property="og:description" content="Another problem I came across recently was fixed height user controls. Someone at work had created a fixed height user control, by putting the following code in the paint event:
Me.Width = 20 Now while for the majority of cases this works, it doesn&rsquo;t if you dock the control to the left or right of the form, as each time the Layout Engine tries to stick the top of the control to the top of the parent and the bottom of the control to the bottom of the parent, it fires the Paint() event."><meta property="og:type" content="article"><meta property="og:url" content="https://andydote.co.uk/2008/03/29/vbnet-c-fixed-height-user-controls/"><meta property="article:section" content="post"><meta property="article:published_time" content="2008-03-29T00:00:00+00:00"><meta property="article:modified_time" content="2008-03-29T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="VB.NET &amp;amp; C# Fixed height User Controls"><meta name=twitter:description content="Another problem I came across recently was fixed height user controls. Someone at work had created a fixed height user control, by putting the following code in the paint event:
Me.Width = 20 Now while for the majority of cases this works, it doesn&rsquo;t if you dock the control to the left or right of the form, as each time the Layout Engine tries to stick the top of the control to the top of the parent and the bottom of the control to the bottom of the parent, it fires the Paint() event."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://andydote.co.uk/post/"},{"@type":"ListItem","position":3,"name":"VB.NET \u0026amp; C# Fixed height User Controls","item":"https://andydote.co.uk/2008/03/29/vbnet-c-fixed-height-user-controls/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"VB.NET \u0026amp; C# Fixed height User Controls","name":"VB.NET \u0026amp; C# Fixed height User Controls","description":"Another problem I came across recently was fixed height user controls. Someone at work had created a fixed height user control, by putting the following code in the paint event:\nMe.Width = 20 Now while for the majority of cases this works, it doesn\u0026rsquo;t if you dock the control to the left or right of the form, as each time the Layout Engine tries to stick the top of the control to the top of the parent and the bottom of the control to the bottom of the parent, it fires the Paint() event.","keywords":["design","controls","c#"],"articleBody":"Another problem I came across recently was fixed height user controls. Someone at work had created a fixed height user control, by putting the following code in the paint event:\nMe.Width = 20 Now while for the majority of cases this works, it doesn’t if you dock the control to the left or right of the form, as each time the Layout Engine tries to stick the top of the control to the top of the parent and the bottom of the control to the bottom of the parent, it fires the Paint() event. This causes the user control to change its size, which causes the Layout Engine to activate, and the whole cycle starts over, and as a by product, creates a horrid flickering.\nSome suggestions were made to fix the problem such as disabling docking (why fix a problem by causing another one?), moving the code to the resize event (same effect, with the added benefit of allowing a resize until it is complete, then resizing…).\nSome googling revealed one very angry fellow on the xtreme dot net talk forums, and no real answer. The method he had tried was to set the following flag in the initialize event:\nControl.SetStyle(ControlStyles.FixedHeight, true) Which if you read the documentation for ControlStyles.FixedHeight (it’s on the intellitype, so there’s no reason for not doing so) it says the following:\nIf true, the control has a fixed height when auto-scaled. For example, if a layout operation attempts to rescale the control to accommodate a new Font, the control’s Height remains unchanged.\nSo another solution was needed. In the end, I and a fellow developer found that overriding the controls MaximumHeight and MinimumHeight was the way to do it:\nConst MaxHeight As Integer = 20 Public Overrides Property MaximumSize() As Drawing.Size Get Return New Drawing.Size(MyBase.MaximumSize.Width, MaxHeight) End Get Set(ByVal value As Drawing.Size) MyBase.MaximumSize = New Drawing.Size(value.Width, MaxHeight) End Set End Property Public Overrides Property MinimumSize() As Drawing.Size Get Return New Drawing.Size(MyBase.MinimumSize.Width, MaxHeight) End Get Set(ByVal value As Drawing.Size) MyBase.MinimumSize = New Drawing.Size(value.Width, MaxHeight) End Set End Property This allows the end user to modify the maximum width (in this case) to their heart’s content, and still have a control of fixed height, that can be docked properly, doesn’t flicker, and above all resizes properly in the forms designer.\n","wordCount":"384","inLanguage":"en","datePublished":"2008-03-29T00:00:00Z","dateModified":"2008-03-29T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://andydote.co.uk/2008/03/29/vbnet-c-fixed-height-user-controls/"},"publisher":{"@type":"Organization","name":"Andy Dote","logo":{"@type":"ImageObject","url":"https://andydote.co.uk/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://andydote.co.uk accesskey=h title="Andy Dote (Alt + H)">Andy Dote</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://andydote.co.uk/archive title=Archive><span>Archive</span></a></li><li><a href=https://andydote.co.uk/talks title=Talks><span>Talks</span></a></li><li><a href=https://andydote.co.uk/notes title=Notes><span>Notes</span></a></li><li><a href=https://andydote.co.uk/tags title=Tags><span>Tags</span></a></li><li><a href=https://andydote.co.uk/contact title=Contact><span>Contact</span></a></li><li><a href=https://andydote.co.uk/rss.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>VB.NET &amp;amp; C# Fixed height User Controls</h1><div class=post-meta>&lt;span title='2008-03-29 00:00:00 +0000 UTC'>March 29, 2008&lt;/span>&amp;nbsp;·&amp;nbsp;2 min</div></header><div class=post-content><p>Another problem I came across recently was fixed height user controls. Someone at work had created a fixed height user control, by putting the following code in the paint event:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb data-lang=vb><span style=display:flex><span><span style=color:#66d9ef>Me</span>.Width <span style=color:#f92672>=</span> 20
</span></span></code></pre></div><p>Now while for the majority of cases this works, it doesn&rsquo;t if you dock the control to the left or right of the form, as each time the Layout Engine tries to stick the top of the control to the top of the parent and the bottom of the control to the bottom of the parent, it fires the <code>Paint()</code> event. This causes the user control to change its size, which causes the Layout Engine to activate, and the whole cycle starts over, and as a by product, creates a horrid flickering.</p><p>Some suggestions were made to fix the problem such as disabling docking (why fix a problem by causing another one?), moving the code to the resize event (same effect, with the added benefit of allowing a resize until it is complete, then resizing&mldr;).</p><p>Some googling revealed one very angry fellow on the <a href="http://www.xtremedotnettalk.com/showthread.php?t=94118">xtreme dot net talk</a> forums, and no real answer. The method he had tried was to set the following flag in the initialize event:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb data-lang=vb><span style=display:flex><span>Control.SetStyle(ControlStyles.FixedHeight, <span style=color:#66d9ef>true</span>)
</span></span></code></pre></div><p>Which if you read the documentation for ControlStyles.FixedHeight (it&rsquo;s on the intellitype, so there&rsquo;s no reason for not doing so) it says the following:</p><p>If true, the control has a fixed height when auto-scaled. For example, if a layout operation attempts to rescale the control to accommodate a new Font, the control&rsquo;s Height remains unchanged.</p><p>So another solution was needed. In the end, I and a fellow developer found that overriding the controls MaximumHeight and MinimumHeight was the way to do it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb data-lang=vb><span style=display:flex><span><span style=color:#66d9ef>Const</span> MaxHeight <span style=color:#f92672>As</span> <span style=color:#66d9ef>Integer</span> <span style=color:#f92672>=</span> 20
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Overrides</span> <span style=color:#66d9ef>Property</span> <span style=color:#a6e22e>MaximumSize</span>() <span style=color:#f92672>As</span> Drawing.Size
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Get</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>Return</span> <span style=color:#66d9ef>New</span> Drawing.Size(<span style=color:#66d9ef>MyBase</span>.MaximumSize.Width, MaxHeight)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Get</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Set</span>(<span style=color:#66d9ef>ByVal</span> value <span style=color:#f92672>As</span> Drawing.Size)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>MyBase</span>.MaximumSize <span style=color:#f92672>=</span> <span style=color:#66d9ef>New</span> Drawing.Size(value.Width, MaxHeight)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Set</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Property</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>Public</span> <span style=color:#66d9ef>Overrides</span> <span style=color:#66d9ef>Property</span> <span style=color:#a6e22e>MinimumSize</span>() <span style=color:#f92672>As</span> Drawing.Size
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Get</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>Return</span> <span style=color:#66d9ef>New</span> Drawing.Size(<span style=color:#66d9ef>MyBase</span>.MinimumSize.Width, MaxHeight)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Get</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Set</span>(<span style=color:#66d9ef>ByVal</span> value <span style=color:#f92672>As</span> Drawing.Size)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>MyBase</span>.MinimumSize <span style=color:#f92672>=</span> <span style=color:#66d9ef>New</span> Drawing.Size(value.Width, MaxHeight)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Set</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Property</span>
</span></span></code></pre></div><p>This allows the end user to modify the maximum width (in this case) to their heart&rsquo;s content, and still have a control of fixed height, that can be docked properly, doesn&rsquo;t flicker, and above all resizes properly in the forms designer.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://andydote.co.uk/tags/design/>design</a></li><li><a href=https://andydote.co.uk/tags/controls/>controls</a></li><li><a href=https://andydote.co.uk/tags/c#/>c#</a></li></ul><nav class=paginav><a class=prev href=https://andydote.co.uk/2008/03/29/flow-layout-panel-and-scroll-wheel-problem/><span class=title>« Prev Page</span><br><span>Flow Layout Panel and Scroll Wheel Problem</span></a></nav></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
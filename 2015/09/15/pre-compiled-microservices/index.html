<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Running pre-compiled microservices in Docker with Mono | Andy Dote</title><meta name=keywords content="design,microservices,docker,mono"><meta name=description content="Last time we went through creating a Dockerfile for a microservice, with the service being compiled on creation of the container image, using xbuild.
However we might not want to compile the application to create the container image, and use an existing version (e.g. one created by a build server.)
Our original Dockerfile was this:
FROM mono:3.10-onbuild RUN apt-get update && apt-get install mono-4.0-service -y CMD [ &#34;mono-service&#34;, &#34;./MicroServiceDemo.exe&#34;, &#34;--no-daemon&#34; ] EXPOSE 12345 We only need to make a few modifications to use a pre-compiled application:"><meta name=author content><link rel=canonical href=https://andydote.co.uk/2015/09/15/pre-compiled-microservices/><link crossorigin=anonymous href=/assets/css/stylesheet.min.2b33c247bf6959372dd097f2cfdcd9f4d5019027cd9b1e28ae3d14c17c37ac00.css integrity="sha256-KzPCR79pWTct0Jfyz9zZ9NUBkCfNmx4orj0UwXw3rAA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/mermaid.min.725f44bd345b0a2a4043ca952b0863edd789e913cf0813a12bbdfe986fe87079.js integrity="sha256-cl9EvTRbCipAQ8qVKwhj7deJ6RPPCBOhK73+mG/ocHk="></script>
<script defer crossorigin=anonymous src=/js/tabs.min.2d019e9ee3574770ad4ecfd4f5f794739892195cb82a4e6383252b9074ab520c.js integrity="sha256-LQGenuNXR3CtTs/U9feUc5iSGVy4Kk5jgyUrkHSrUgw="></script>
<link rel=icon href=https://andydote.co.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://andydote.co.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://andydote.co.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://andydote.co.uk/apple-touch-icon.png><link rel=mask-icon href=https://andydote.co.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Running pre-compiled microservices in Docker with Mono"><meta property="og:description" content="Last time we went through creating a Dockerfile for a microservice, with the service being compiled on creation of the container image, using xbuild.
However we might not want to compile the application to create the container image, and use an existing version (e.g. one created by a build server.)
Our original Dockerfile was this:
FROM mono:3.10-onbuild RUN apt-get update && apt-get install mono-4.0-service -y CMD [ &#34;mono-service&#34;, &#34;./MicroServiceDemo.exe&#34;, &#34;--no-daemon&#34; ] EXPOSE 12345 We only need to make a few modifications to use a pre-compiled application:"><meta property="og:type" content="article"><meta property="og:url" content="https://andydote.co.uk/2015/09/15/pre-compiled-microservices/"><meta property="article:section" content="post"><meta property="article:published_time" content="2015-09-15T00:00:00+00:00"><meta property="article:modified_time" content="2015-09-15T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Running pre-compiled microservices in Docker with Mono"><meta name=twitter:description content="Last time we went through creating a Dockerfile for a microservice, with the service being compiled on creation of the container image, using xbuild.
However we might not want to compile the application to create the container image, and use an existing version (e.g. one created by a build server.)
Our original Dockerfile was this:
FROM mono:3.10-onbuild RUN apt-get update && apt-get install mono-4.0-service -y CMD [ &#34;mono-service&#34;, &#34;./MicroServiceDemo.exe&#34;, &#34;--no-daemon&#34; ] EXPOSE 12345 We only need to make a few modifications to use a pre-compiled application:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://andydote.co.uk/post/"},{"@type":"ListItem","position":3,"name":"Running pre-compiled microservices in Docker with Mono","item":"https://andydote.co.uk/2015/09/15/pre-compiled-microservices/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Running pre-compiled microservices in Docker with Mono","name":"Running pre-compiled microservices in Docker with Mono","description":"Last time we went through creating a Dockerfile for a microservice, with the service being compiled on creation of the container image, using xbuild.\nHowever we might not want to compile the application to create the container image, and use an existing version (e.g. one created by a build server.)\nOur original Dockerfile was this:\nFROM mono:3.10-onbuild RUN apt-get update \u0026amp;\u0026amp; apt-get install mono-4.0-service -y CMD [ \u0026#34;mono-service\u0026#34;, \u0026#34;./MicroServiceDemo.exe\u0026#34;, \u0026#34;--no-daemon\u0026#34; ] EXPOSE 12345 We only need to make a few modifications to use a pre-compiled application:","keywords":["design","microservices","docker","mono"],"articleBody":"Last time we went through creating a Dockerfile for a microservice, with the service being compiled on creation of the container image, using xbuild.\nHowever we might not want to compile the application to create the container image, and use an existing version (e.g. one created by a build server.)\nOur original Dockerfile was this:\nFROM mono:3.10-onbuild RUN apt-get update \u0026\u0026 apt-get install mono-4.0-service -y CMD [ \"mono-service\", \"./MicroServiceDemo.exe\", \"--no-daemon\" ] EXPOSE 12345 We only need to make a few modifications to use a pre-compiled application:\nFROM mono:3.10.0 RUN apt-get update \u0026\u0026 apt-get install mono-4.0-service -y RUN mkdir -p /usr/src/app COPY . /usr/src/app WORKDIR /usr/src/app CMD [ \"mono-service\", \"./MicroServiceDemo.exe\", \"--no-daemon\" ] EXPOSE 12345 Asides from changing the base image to mono:3.10.0, the only changes made are to add the following lines:\nRUN mkdir -p /usr/src/app COPY . /usr/src/app WORKDIR /usr/src/app These lines create a new directory for our application, copy the contents of the current directory (e.g. the paths specified when you type docker build -t servicedemo .) and make the directory our working directory.\nYou can now create a container with the same commands as last time:\ndocker build -t servicedemo . docker run -d -p 12345:12345 --name demo servicedemo There is a demo project for all of this on my github: DockerMonoDemo.\n","wordCount":"214","inLanguage":"en","datePublished":"2015-09-15T00:00:00Z","dateModified":"2015-09-15T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://andydote.co.uk/2015/09/15/pre-compiled-microservices/"},"publisher":{"@type":"Organization","name":"Andy Dote","logo":{"@type":"ImageObject","url":"https://andydote.co.uk/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://andydote.co.uk accesskey=h title="Andy Dote (Alt + H)">Andy Dote</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://andydote.co.uk/archive title=Archive><span>Archive</span></a></li><li><a href=https://andydote.co.uk/talks title=Talks><span>Talks</span></a></li><li><a href=https://andydote.co.uk/notes title=Notes><span>Notes</span></a></li><li><a href=https://andydote.co.uk/tags title=Tags><span>Tags</span></a></li><li><a href=https://andydote.co.uk/contact title=Contact><span>Contact</span></a></li><li><a href=https://andydote.co.uk/rss.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Running pre-compiled microservices in Docker with Mono</h1><div class=post-meta><span title='2015-09-15 00:00:00 +0000 UTC'>September 15, 2015</span>&nbsp;·&nbsp;2 min</div></header><div class=post-content><p>Last time we went through <a href=/2015/09/05/running-microservices-in-docker-with-mono.html>creating a Dockerfile for a microservice</a>, with the service being compiled on creation of the container image, using xbuild.</p><p>However we might not want to compile the application to create the container image, and use an existing version (e.g. one created by a build server.)</p><p>Our original Dockerfile was this:</p><pre tabindex=0><code>FROM mono:3.10-onbuild
RUN apt-get update &amp;&amp; apt-get install mono-4.0-service -y

CMD [ &#34;mono-service&#34;,  &#34;./MicroServiceDemo.exe&#34;, &#34;--no-daemon&#34; ]
EXPOSE 12345
</code></pre><p>We only need to make a few modifications to use a pre-compiled application:</p><pre tabindex=0><code>FROM mono:3.10.0
RUN apt-get update &amp;&amp; apt-get install mono-4.0-service -y

RUN mkdir -p /usr/src/app
COPY . /usr/src/app
WORKDIR /usr/src/app

CMD [ &#34;mono-service&#34;,  &#34;./MicroServiceDemo.exe&#34;, &#34;--no-daemon&#34; ]
EXPOSE 12345
</code></pre><p>Asides from changing the base image to <code>mono:3.10.0</code>, the only changes made are to add the following lines:</p><pre tabindex=0><code>RUN mkdir -p /usr/src/app
COPY . /usr/src/app
WORKDIR /usr/src/app
</code></pre><p>These lines create a new directory for our application, copy the contents of the current directory (e.g. the paths specified when you type <code>docker build -t servicedemo .</code>) and make the directory our working directory.</p><p>You can now create a container with the same commands as last time:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker build -t servicedemo .
</span></span><span style=display:flex><span>docker run -d -p 12345:12345 --name demo servicedemo
</span></span></code></pre></div><p>There is a demo project for all of this on my github: <a href=https://github.com/Pondidum/DockerMonoDemo>DockerMonoDemo</a>.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://andydote.co.uk/tags/design/>design</a></li><li><a href=https://andydote.co.uk/tags/microservices/>microservices</a></li><li><a href=https://andydote.co.uk/tags/docker/>docker</a></li><li><a href=https://andydote.co.uk/tags/mono/>mono</a></li></ul><nav class=paginav><a class=prev href=https://andydote.co.uk/2015/09/21/webapi-post-plaintext/><span class=title>« Prev Page</span><br><span>Posting PlainText to Asp WebApi</span></a>
<a class=next href=https://andydote.co.uk/2015/09/05/running-microservices-in-docker-with-mono/><span class=title>Next Page »</span><br><span>Running microservices in Docker with Mono</span></a></nav></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
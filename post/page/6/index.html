<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | Andy Dote</title><meta name=keywords content><meta name=description content="Posts - Andy Dote"><meta name=author content><link rel=canonical href=https://andydote.co.uk/post/><link crossorigin=anonymous href=/assets/css/stylesheet.min.d3aaf8cdcec9a6487824ab95cadf08232ec362e7ba510c6b742973d16ef5b72e.css integrity="sha256-06r4zc7Jpkh4JKuVyt8IIy7DYue6UQxrdClz0W71ty4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/mermaid.min.725f44bd345b0a2a4043ca952b0863edd789e913cf0813a12bbdfe986fe87079.js integrity="sha256-cl9EvTRbCipAQ8qVKwhj7deJ6RPPCBOhK73+mG/ocHk="></script>
<script defer crossorigin=anonymous src=/js/tabs.min.2d019e9ee3574770ad4ecfd4f5f794739892195cb82a4e6383252b9074ab520c.js integrity="sha256-LQGenuNXR3CtTs/U9feUc5iSGVy4Kk5jgyUrkHSrUgw="></script>
<link rel=icon href=https://andydote.co.uk/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://andydote.co.uk/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://andydote.co.uk/favicon-32x32.png><link rel=apple-touch-icon href=https://andydote.co.uk/apple-touch-icon.png><link rel=mask-icon href=https://andydote.co.uk/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://andydote.co.uk/post/rss.xml><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Posts"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://andydote.co.uk/post/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Posts"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://andydote.co.uk/post/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://andydote.co.uk accesskey=h title="Andy Dote (Alt + H)">Andy Dote</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://andydote.co.uk/archive title=Archive><span>Archive</span></a></li><li><a href=https://andydote.co.uk/talks title=Talks><span>Talks</span></a></li><li><a href=https://andydote.co.uk/notes title=Notes><span>Notes</span></a></li><li><a href=https://andydote.co.uk/tags title=Tags><span>Tags</span></a></li><li><a href=https://andydote.co.uk/contact title=Contact><span>Contact</span></a></li><li><a href=https://andydote.co.uk/rss.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><header class=page-header><h1>Posts</h1></header><article class=post-entry><header class=entry-header><h2>Feature Toggles with Consul</h2></header><div class=entry-content><p>Feature Toggles are a great way of helping to deliver working software, although there are a few things which could go wrong. See my talk Feature Toggles: The Good, The Bad and The Ugly for some interesting stories and insights on it!
I was talking with a colleague the other day about how you could go about implementing Feature Toggles in a centralised manner into an existing system, preferably with a little overhead as possible....</p></div><footer class=entry-footer><span title='2018-09-06 00:00:00 +0000 UTC'>September 6, 2018</span>&nbsp;·&nbsp;4 min</footer><a class=entry-link aria-label="post link to Feature Toggles with Consul" href=https://andydote.co.uk/2018/09/06/consul-feature-toggles/></a></article><article class=post-entry><header class=entry-header><h2>Validate Your Configuration</h2></header><div class=entry-content><p>As I have written many times before, your application’s configuration should be strongly typed and validated that it loads correctly at startup.
This means not only that the source values (typically all represented as strings) can be converted to the target types (int, Uri, TimeSpan etc) but that the values are semantically valid too.
For example, if you have a web.config file with the following AppSetting, and a configuration class to go with it:...</p></div><footer class=entry-footer><span title='2018-08-26 00:00:00 +0000 UTC'>August 26, 2018</span>&nbsp;·&nbsp;3 min</footer><a class=entry-link aria-label="post link to Validate Your Configuration" href=https://andydote.co.uk/2018/08/26/validate-configuration/></a></article><article class=post-entry><header class=entry-header><h2>Branching and Red Builds</h2></header><div class=entry-content><p>So this is a bit of a rant…but hopefully with some solutions and workarounds too. So let’s kick things off with a nice statement:
I hate broken builds.
So everyone basically agrees on this point I think. The problem is that I mean all builds, including ones on shared feature branches.
Currently, I work on a number of projects which uses small(ish) feature branches. The way this works is that the team agrees on a new feature to work on creates a branch, and then each developer works on tasks, committing on their own branches, and Pull-Requesting to the feature branch....</p></div><footer class=entry-footer><span title='2018-08-10 00:00:00 +0000 UTC'>August 10, 2018</span>&nbsp;·&nbsp;3 min</footer><a class=entry-link aria-label="post link to Branching and Red Builds" href=https://andydote.co.uk/2018/08/10/red-builds/></a></article><article class=post-entry><header class=entry-header><h2>Managing AppSettings in Consul</h2></header><div class=entry-content><p>Consul is a great utility to make running your microservice architecture very simple. Amongst other things, it provides Service Discovery, Health Checks, and Configuration. In this post, we are going to be looking at Configuration; not specifically how to read from Consul, but about how we put configuration data into Consul in the first place.
The usual flow for an application using Consul for configuration is as follows:
App Starts Fetches configuration from Consul Configures itself Registers in Consul for Service Discovery Ready Step 2 is very straightforward - you query the local instance of Consul’s HTTP API, and read the response into your configuration object (If you’re using Microsoft’s Configuration libraries on dotnet core, you can use the Consul....</p></div><footer class=entry-footer><span title='2018-08-07 00:00:00 +0000 UTC'>August 7, 2018</span>&nbsp;·&nbsp;4 min</footer><a class=entry-link aria-label="post link to Managing AppSettings in Consul" href=https://andydote.co.uk/2018/08/07/managing-consul-appsettings/></a></article><article class=post-entry><header class=entry-header><h2>Locking Vault Down with Policies</h2></header><div class=entry-content><p>The final part of my Vault miniseries focuses on permissioning, which is provided by Vault’s Policies.
As everything in Vault is represented as a path, the policies DSL (Domain Specific Language) just needs to apply permissions to paths to lock things down. For example, to allow all operations on the cubbyhole secret engine, we would define this policy:
path "cubbyhole/*" { capabilities = ["create", "read", "update", "delete", "list"] } Vault comes with a default policy which allows token operations (such as looking up its own token info, releasing and renewing tokens), and cubbyhole access....</p></div><footer class=entry-footer><span title='2018-06-23 00:00:00 +0000 UTC'>June 23, 2018</span>&nbsp;·&nbsp;4 min</footer><a class=entry-link aria-label="post link to Locking Vault Down with Policies" href=https://andydote.co.uk/2018/06/23/vault-locking-it-down-with-policies/></a></article><article class=post-entry><header class=entry-header><h2>Secure Communication with Vault</h2></header><div class=entry-content><p>I think Vault by Hashicorp is a great product - I particularly love how you can do dynamic secret generation (e.g for database connections). But how do you validate that the application requesting the secret is allowed to perform that action? How do you know it’s not someone or something impersonating your application?
While musing this at an airport the other day, my colleague Patrik sent me a link to a StackOverflow post about this very question...</p></div><footer class=entry-footer><span title='2018-06-22 00:00:00 +0000 UTC'>June 22, 2018</span>&nbsp;·&nbsp;5 min</footer><a class=entry-link aria-label="post link to Secure Communication with Vault" href=https://andydote.co.uk/2018/06/22/vault-secure-communication/></a></article><article class=post-entry><header class=entry-header><h2>Fixing Docker volume paths on Git Bash on Windows</h2></header><div class=entry-content><p>My normal development laptop runs Windows, but like a lot of developers, I make huge use of Docker, which I run under Hyper-V. I also heavily use the git bash terminal on windows to work.
Usually, everything works as expected, but I was recently trying to run an ELK (Elasticsearch, Logstash, Kibana) container, and needed to pass in an extra configuration file for Logstash. This caused me a lot of trouble, as nothing was working as expected....</p></div><footer class=entry-footer><span title='2018-06-18 00:00:00 +0000 UTC'>June 18, 2018</span>&nbsp;·&nbsp;2 min</footer><a class=entry-link aria-label="post link to Fixing Docker volume paths on Git Bash on Windows" href=https://andydote.co.uk/2018/06/18/git-bash-docker-volume-paths/></a></article><article class=post-entry><header class=entry-header><h2>Managing Postgres Connection Strings with Vault</h2></header><div class=entry-content><p>One of the points I made in my recent NDC talk on 12 Factor microservices, was that you shouldn’t be storing sensitive data, such as API keys, usernames, passwords etc. in the environment variables.
Don’t Store Sensitive Data in the Environment
My reasoning is that when you were accessing Environment Variables in Heroku’s platform, you were actually accessing some (probably) secure key-value store, rather than actual environment variables.
While you can use something like Consul’s key-value store for this, it’s not much better as it still stores all the values in plaintext, and has no auditing or logging....</p></div><footer class=entry-footer><span title='2018-06-17 00:00:00 +0000 UTC'>June 17, 2018</span>&nbsp;·&nbsp;6 min</footer><a class=entry-link aria-label="post link to Managing Postgres Connection Strings with Vault" href=https://andydote.co.uk/2018/06/17/secret-management-vault-postgres-connection/></a></article><article class=post-entry><header class=entry-header><h2>Writing Conference Talks</h2></header><div class=entry-content><p>I saw an interesting question on twitter today:
Hey, people who talk at things: How long does it take you to put a new talk together?
I need like 50 hours over at least a couple of months to make something I don’t hate. I’m trying to get that down (maybe by not doing pictures?) but wondering what’s normal for everyone else.
Source
I don’t know how long it takes me to write a talk - as it is usually spread over many weeks/months, worked on as and when I have inspiration....</p></div><footer class=entry-footer><span title='2018-05-15 00:00:00 +0000 UTC'>May 15, 2018</span>&nbsp;·&nbsp;3 min</footer><a class=entry-link aria-label="post link to Writing Conference Talks" href=https://andydote.co.uk/2018/05/15/writing-conference-talks/></a></article><article class=post-entry><header class=entry-header><h2>Test Expressiveness</h2></header><div class=entry-content><p>We have a test suite at work which tests a retry decorator class works as expected. One of the tests checks that when the inner implementation throws an exception, it will log the number of times it has failed:
[Test] public async Task ShouldLogRetries() { var mockClient = Substitute.For&lt;IContractProvider>(); var logger = Subsitute.For&lt;ILogger>(); var sut = new RetryDecorator(mockClient, logger, maxRetries: 3); mockClient .GetContractPdf(Arg.Any&lt;string>()) .Throws(new ContractDownloadException()); try { await sut.GetContractPdf("foo"); } catch (Exception e){} logger....</p></div><footer class=entry-footer><span title='2018-02-26 00:00:00 +0000 UTC'>February 26, 2018</span>&nbsp;·&nbsp;2 min</footer><a class=entry-link aria-label="post link to Test Expressiveness" href=https://andydote.co.uk/2018/02/26/test-expressiveness/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://andydote.co.uk/post/page/5/>« Prev Page</a>
<a class=next href=https://andydote.co.uk/post/page/7/>Next Page »</a></nav></footer></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>